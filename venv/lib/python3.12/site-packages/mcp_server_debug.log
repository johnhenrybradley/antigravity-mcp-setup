2026-01-29 19:36:09,160 - auth.scopes - INFO - 35806 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['gmail', 'drive', 'calendar', 'docs', 'sheets', 'chat', 'forms', 'slides', 'tasks', 'search', 'appscript']
2026-01-29 19:36:09,313 - core.utils - INFO - 35806 - MainThread [utils.check_credentials_directory_permissions:73] - Created credentials directory with proper permissions: /home/john/.google_workspace_mcp/credentials
2026-01-29 19:36:09,313 - core.server - INFO - 35806 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 19:36:09,313 - auth.oauth_callback_server - INFO - 35806 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8000
2026-01-29 19:36:09,327 - auth.oauth_callback_server - INFO - 35806 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 19:36:09,429 - auth.oauth_callback_server - INFO - 35806 - MainThread [oauth_callback_server.start:192] - Minimal OAuth server started on localhost:8000
2026-01-29 19:36:09,429 - auth.oauth_callback_server - INFO - 35806 - MainThread [oauth_callback_server.ensure_oauth_callback_available:264] - Minimal OAuth server successfully started on http://localhost:8000
2026-01-29 19:36:09,465 - httpx - INFO - 35806 - MainThread [_client._send_single_request:1025] - HTTP Request: GET https://pypi.org/pypi/fastmcp/json "HTTP/1.1 200 OK"
2026-01-29 19:36:09,502 - docket.worker - INFO - 35806 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#35806' with the following tasks:
2026-01-29 19:36:09,502 - docket.worker - INFO - 35806 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 19:36:09,502 - docket.worker - INFO - 35806 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 19:36:09,502 - docket.worker - INFO - 35806 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 19:37:54,806 - auth.scopes - INFO - 35906 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['gmail', 'drive', 'calendar', 'docs', 'sheets', 'chat', 'forms', 'slides', 'tasks', 'search', 'appscript']
2026-01-29 19:37:54,949 - core.utils - INFO - 35906 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-29 19:37:54,949 - core.server - INFO - 35906 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 19:37:54,949 - auth.oauth_callback_server - INFO - 35906 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8000
2026-01-29 19:37:54,962 - auth.oauth_callback_server - INFO - 35906 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 19:37:54,962 - auth.oauth_callback_server - ERROR - 35906 - MainThread [oauth_callback_server.start:159] - Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:37:54,962 - auth.oauth_callback_server - ERROR - 35906 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8000: Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:37:54,994 - docket.worker - INFO - 35906 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#35906' with the following tasks:
2026-01-29 19:37:54,994 - docket.worker - INFO - 35906 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 19:37:54,994 - docket.worker - INFO - 35906 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 19:37:54,994 - docket.worker - INFO - 35906 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 19:37:55,004 - mcp.server.lowlevel.server - INFO - 35906 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-29 19:39:39,465 - auth.scopes - INFO - 36022 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-29 19:39:39,506 - core.utils - INFO - 36022 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-29 19:39:39,506 - core.server - INFO - 36022 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 19:39:39,506 - auth.oauth_callback_server - INFO - 36022 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8000
2026-01-29 19:39:39,519 - auth.oauth_callback_server - INFO - 36022 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 19:39:39,519 - auth.oauth_callback_server - ERROR - 36022 - MainThread [oauth_callback_server.start:159] - Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:39:39,519 - auth.oauth_callback_server - ERROR - 36022 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8000: Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:39:39,591 - docket.worker - INFO - 36022 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#36022' with the following tasks:
2026-01-29 19:39:39,591 - docket.worker - INFO - 36022 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 19:39:39,591 - docket.worker - INFO - 36022 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 19:39:39,591 - docket.worker - INFO - 36022 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 19:39:39,599 - mcp.server.lowlevel.server - INFO - 36022 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-29 19:40:10,313 - auth.scopes - INFO - 36284 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-29 19:40:10,364 - core.utils - INFO - 36284 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-29 19:40:10,365 - core.server - INFO - 36284 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 19:40:10,365 - auth.oauth_callback_server - INFO - 36284 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8000
2026-01-29 19:40:10,378 - auth.oauth_callback_server - INFO - 36284 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 19:40:10,379 - auth.oauth_callback_server - ERROR - 36284 - MainThread [oauth_callback_server.start:159] - Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:40:10,379 - auth.oauth_callback_server - ERROR - 36284 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8000: Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:40:10,444 - docket.worker - INFO - 36284 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#36284' with the following tasks:
2026-01-29 19:40:10,445 - docket.worker - INFO - 36284 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 19:40:10,445 - docket.worker - INFO - 36284 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 19:40:10,445 - docket.worker - INFO - 36284 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 19:40:10,453 - mcp.server.lowlevel.server - INFO - 36284 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-29 19:40:43,585 - auth.scopes - INFO - 36346 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-29 19:40:43,624 - core.utils - INFO - 36346 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-29 19:40:43,624 - core.server - INFO - 36346 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 19:40:43,625 - auth.oauth_callback_server - INFO - 36346 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8000
2026-01-29 19:40:43,637 - auth.oauth_callback_server - INFO - 36346 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 19:40:43,637 - auth.oauth_callback_server - ERROR - 36346 - MainThread [oauth_callback_server.start:159] - Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:40:43,638 - auth.oauth_callback_server - ERROR - 36346 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8000: Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:40:43,700 - docket.worker - INFO - 36346 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#36346' with the following tasks:
2026-01-29 19:40:43,700 - docket.worker - INFO - 36346 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 19:40:43,700 - docket.worker - INFO - 36346 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 19:40:43,700 - docket.worker - INFO - 36346 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 19:40:43,707 - mcp.server.lowlevel.server - INFO - 36346 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-29 19:41:33,136 - auth.scopes - INFO - 36632 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-29 19:41:33,183 - core.utils - INFO - 36632 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-29 19:41:33,183 - core.server - INFO - 36632 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 19:41:33,183 - auth.oauth_callback_server - INFO - 36632 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8000
2026-01-29 19:41:33,198 - auth.oauth_callback_server - INFO - 36632 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 19:41:33,198 - auth.oauth_callback_server - ERROR - 36632 - MainThread [oauth_callback_server.start:159] - Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:41:33,198 - auth.oauth_callback_server - ERROR - 36632 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8000: Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:41:33,274 - docket.worker - INFO - 36632 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#36632' with the following tasks:
2026-01-29 19:41:33,274 - docket.worker - INFO - 36632 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 19:41:33,274 - docket.worker - INFO - 36632 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 19:41:33,274 - docket.worker - INFO - 36632 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 19:41:33,282 - mcp.server.lowlevel.server - INFO - 36632 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-29 19:41:41,215 - auth.scopes - INFO - 36676 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-29 19:41:41,261 - core.utils - INFO - 36676 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-29 19:41:41,261 - core.server - INFO - 36676 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 19:41:41,262 - auth.oauth_callback_server - INFO - 36676 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8000
2026-01-29 19:41:41,275 - auth.oauth_callback_server - INFO - 36676 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 19:41:41,275 - auth.oauth_callback_server - ERROR - 36676 - MainThread [oauth_callback_server.start:159] - Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:41:41,275 - auth.oauth_callback_server - ERROR - 36676 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8000: Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:41:41,352 - docket.worker - INFO - 36676 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#36676' with the following tasks:
2026-01-29 19:41:41,352 - docket.worker - INFO - 36676 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 19:41:41,352 - docket.worker - INFO - 36676 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 19:41:41,352 - docket.worker - INFO - 36676 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 19:41:41,361 - mcp.server.lowlevel.server - INFO - 36676 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-29 19:42:03,319 - mcp.server.lowlevel.server - INFO - 36346 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 19:42:03,321 - auth.auth_info_middleware - INFO - 36346 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 19:42:03,321 - auth.service_decorator - INFO - 36346 - MainThread [service_decorator._get_auth_context:80] - [list_drive_items] Auth from middleware: authenticated_user=None, auth_method=None, session_id=915a9e50-edfc-4031-8600-e22765805ae0
2026-01-29 19:42:03,321 - auth.google_auth - INFO - 36346 - MainThread [google_auth.get_authenticated_google_service:868] - [list_drive_items] Attempting to get authenticated drive service. Email: 'john@example.com', Session: '915a9e50-edfc-4031-8600-e22765805ae0'
2026-01-29 19:42:03,322 - auth.credential_store - INFO - 36346 - asyncio_0 [credential_store.__init__:111] - Using default credentials directory: /home/john/.google_workspace_mcp/credentials
2026-01-29 19:42:03,323 - auth.credential_store - INFO - 36346 - asyncio_0 [credential_store.__init__:114] - LocalDirectoryCredentialStore initialized with base_dir: /home/john/.google_workspace_mcp/credentials
2026-01-29 19:42:03,323 - auth.credential_store - INFO - 36346 - asyncio_0 [credential_store.get_credential_store:249] - Initialized credential store: LocalDirectoryCredentialStore
2026-01-29 19:42:03,323 - auth.google_auth - INFO - 36346 - asyncio_0 [google_auth.get_credentials:683] - [get_credentials] No credentials found for user 'john@example.com' or session '915a9e50-edfc-4031-8600-e22765805ae0'.
2026-01-29 19:42:03,324 - auth.google_auth - WARNING - 36346 - MainThread [google_auth.get_authenticated_google_service:887] - [list_drive_items] No valid credentials. Email: 'john@example.com'.
2026-01-29 19:42:03,324 - auth.google_auth - INFO - 36346 - MainThread [google_auth.get_authenticated_google_service:890] - [list_drive_items] Valid email 'john@example.com' provided, initiating auth flow.
2026-01-29 19:42:03,325 - auth.oauth_callback_server - INFO - 36346 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 19:42:03,326 - auth.oauth_callback_server - ERROR - 36346 - MainThread [oauth_callback_server.start:159] - Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:42:03,326 - auth.oauth_callback_server - ERROR - 36346 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8000: Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:42:03,327 - auth.service_decorator - ERROR - 36346 - MainThread [service_decorator.wrapper:664] - [list_drive_items] GoogleAuthenticationError during authentication. Method=none, User=none, Service=drive vv3, MCPSessionID=915a9e50-edfc-4031-8600-e22765805ae0: Cannot initiate OAuth flow - callback server unavailable (Port 8000 is already in use on localhost. Cannot start minimal OAuth server.)
2026-01-29 19:42:03,396 - auth.auth_info_middleware - ERROR - 36346 - MainThread [auth_info_middleware.on_call_tool:414] - Error in on_call_tool middleware: Error calling tool 'list_drive_items': Cannot initiate OAuth flow - callback server unavailable (Port 8000 is already in use on localhost. Cannot start minimal OAuth server.)
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 160, in call_tool
    return await tool.run(arguments)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool.py", line 383, in run
    result = await result
             ^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 653, in wrapper
    service, actual_user_email = await _authenticate_service(
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 215, in _authenticate_service
    return await get_authenticated_google_service(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 904, in get_authenticated_google_service
    raise GoogleAuthenticationError(
auth.google_auth.GoogleAuthenticationError: Cannot initiate OAuth flow - callback server unavailable (Port 8000 is already in use on localhost. Cannot start minimal OAuth server.)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/auth_info_middleware.py", line 403, in on_call_tool
    result = await call_next(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/server/server.py", line 1678, in _call_tool
    return await self._tool_manager.call_tool(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 170, in call_tool
    raise ToolError(f"Error calling tool {key!r}: {e}") from e
fastmcp.exceptions.ToolError: Error calling tool 'list_drive_items': Cannot initiate OAuth flow - callback server unavailable (Port 8000 is already in use on localhost. Cannot start minimal OAuth server.)
2026-01-29 19:42:47,000 - mcp.server.lowlevel.server - INFO - 36346 - MainThread [server._handle_request:720] - Processing request of type ListResourcesRequest
2026-01-29 19:43:50,280 - mcp.server.lowlevel.server - INFO - 36346 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 19:43:50,281 - auth.auth_info_middleware - INFO - 36346 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 19:43:50,282 - auth.service_decorator - INFO - 36346 - MainThread [service_decorator._get_auth_context:80] - [list_drive_items] Auth from middleware: authenticated_user=None, auth_method=None, session_id=915a9e50-edfc-4031-8600-e22765805ae0
2026-01-29 19:43:50,282 - auth.google_auth - INFO - 36346 - MainThread [google_auth.get_authenticated_google_service:868] - [list_drive_items] Attempting to get authenticated drive service. Email: 'john@example.com', Session: '915a9e50-edfc-4031-8600-e22765805ae0'
2026-01-29 19:43:50,283 - auth.google_auth - INFO - 36346 - asyncio_0 [google_auth.get_credentials:683] - [get_credentials] No credentials found for user 'john@example.com' or session '915a9e50-edfc-4031-8600-e22765805ae0'.
2026-01-29 19:43:50,283 - auth.google_auth - WARNING - 36346 - MainThread [google_auth.get_authenticated_google_service:887] - [list_drive_items] No valid credentials. Email: 'john@example.com'.
2026-01-29 19:43:50,284 - auth.google_auth - INFO - 36346 - MainThread [google_auth.get_authenticated_google_service:890] - [list_drive_items] Valid email 'john@example.com' provided, initiating auth flow.
2026-01-29 19:43:50,284 - auth.oauth_callback_server - INFO - 36346 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 19:43:50,386 - auth.oauth_callback_server - INFO - 36346 - MainThread [oauth_callback_server.start:192] - Minimal OAuth server started on localhost:8000
2026-01-29 19:43:50,387 - auth.oauth_callback_server - INFO - 36346 - MainThread [oauth_callback_server.ensure_oauth_callback_available:264] - Minimal OAuth server successfully started on http://localhost:8000
2026-01-29 19:43:50,387 - auth.google_auth - INFO - 36346 - MainThread [google_auth.start_auth_flow:357] - [start_auth_flow] Initiating auth for Google Drive for 'john@example.com' with scopes for enabled tools.
2026-01-29 19:43:50,387 - auth.google_auth - WARNING - 36346 - MainThread [google_auth.start_auth_flow:367] - OAUTHLIB_INSECURE_TRANSPORT not set. Setting it for localhost/local development.
2026-01-29 19:43:50,387 - auth.google_auth - ERROR - 36346 - MainThread [google_auth.start_auth_flow:428] - OAuth client credentials not found: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set. Please either:
1. Set environment variables: GOOGLE_OAUTH_CLIENT_ID and GOOGLE_OAUTH_CLIENT_SECRET
2. Ensure '/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json' file exists
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 374, in start_auth_flow
    flow = create_oauth_flow(
           ^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 308, in create_oauth_flow
    raise FileNotFoundError(
FileNotFoundError: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set
2026-01-29 19:43:50,388 - core.utils - ERROR - 36346 - MainThread [utils.wrapper:353] - An unexpected error occurred in list_drive_items: OAuth client credentials not found: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set. Please either:
1. Set environment variables: GOOGLE_OAUTH_CLIENT_ID and GOOGLE_OAUTH_CLIENT_SECRET
2. Ensure '/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json' file exists
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 374, in start_auth_flow
    flow = create_oauth_flow(
           ^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 308, in create_oauth_flow
    raise FileNotFoundError(
FileNotFoundError: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 653, in wrapper
    service, actual_user_email = await _authenticate_service(
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 215, in _authenticate_service
    return await get_authenticated_google_service(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 909, in get_authenticated_google_service
    auth_response = await start_auth_flow(
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 429, in start_auth_flow
    raise Exception(error_text)
Exception: OAuth client credentials not found: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set. Please either:
1. Set environment variables: GOOGLE_OAUTH_CLIENT_ID and GOOGLE_OAUTH_CLIENT_SECRET
2. Ensure '/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json' file exists
2026-01-29 19:43:50,526 - auth.auth_info_middleware - ERROR - 36346 - MainThread [auth_info_middleware.on_call_tool:414] - Error in on_call_tool middleware: Error calling tool 'list_drive_items': An unexpected error occurred in list_drive_items: OAuth client credentials not found: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set. Please either:
1. Set environment variables: GOOGLE_OAUTH_CLIENT_ID and GOOGLE_OAUTH_CLIENT_SECRET
2. Ensure '/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json' file exists
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 374, in start_auth_flow
    flow = create_oauth_flow(
           ^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 308, in create_oauth_flow
    raise FileNotFoundError(
FileNotFoundError: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 653, in wrapper
    service, actual_user_email = await _authenticate_service(
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 215, in _authenticate_service
    return await get_authenticated_google_service(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 909, in get_authenticated_google_service
    auth_response = await start_auth_flow(
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 429, in start_auth_flow
    raise Exception(error_text)
Exception: OAuth client credentials not found: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set. Please either:
1. Set environment variables: GOOGLE_OAUTH_CLIENT_ID and GOOGLE_OAUTH_CLIENT_SECRET
2. Ensure '/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json' file exists

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 160, in call_tool
    return await tool.run(arguments)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool.py", line 383, in run
    result = await result
             ^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 354, in wrapper
    raise Exception(message) from e
Exception: An unexpected error occurred in list_drive_items: OAuth client credentials not found: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set. Please either:
1. Set environment variables: GOOGLE_OAUTH_CLIENT_ID and GOOGLE_OAUTH_CLIENT_SECRET
2. Ensure '/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json' file exists

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/auth_info_middleware.py", line 403, in on_call_tool
    result = await call_next(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/server/server.py", line 1678, in _call_tool
    return await self._tool_manager.call_tool(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 170, in call_tool
    raise ToolError(f"Error calling tool {key!r}: {e}") from e
fastmcp.exceptions.ToolError: Error calling tool 'list_drive_items': An unexpected error occurred in list_drive_items: OAuth client credentials not found: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set. Please either:
1. Set environment variables: GOOGLE_OAUTH_CLIENT_ID and GOOGLE_OAUTH_CLIENT_SECRET
2. Ensure '/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json' file exists
2026-01-29 19:43:50,527 - mcp.server.lowlevel.server - INFO - 36346 - MainThread [server._handle_message:710] - Warning: DeprecationWarning: websockets.legacy is deprecated; see https://websockets.readthedocs.io/en/stable/howto/upgrade.html for upgrade instructions
2026-01-29 19:43:50,527 - mcp.server.lowlevel.server - INFO - 36346 - MainThread [server._handle_message:710] - Warning: DeprecationWarning: websockets.server.WebSocketServerProtocol is deprecated
2026-01-29 19:44:14,729 - mcp.server.lowlevel.server - INFO - 36346 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 19:44:14,731 - auth.auth_info_middleware - INFO - 36346 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 19:44:14,731 - auth.service_decorator - INFO - 36346 - MainThread [service_decorator._get_auth_context:80] - [list_drive_items] Auth from middleware: authenticated_user=None, auth_method=None, session_id=915a9e50-edfc-4031-8600-e22765805ae0
2026-01-29 19:44:14,732 - auth.google_auth - INFO - 36346 - MainThread [google_auth.get_authenticated_google_service:868] - [list_drive_items] Attempting to get authenticated drive service. Email: 'john@example.com', Session: '915a9e50-edfc-4031-8600-e22765805ae0'
2026-01-29 19:44:14,733 - auth.google_auth - INFO - 36346 - asyncio_0 [google_auth.get_credentials:683] - [get_credentials] No credentials found for user 'john@example.com' or session '915a9e50-edfc-4031-8600-e22765805ae0'.
2026-01-29 19:44:14,733 - auth.google_auth - WARNING - 36346 - MainThread [google_auth.get_authenticated_google_service:887] - [list_drive_items] No valid credentials. Email: 'john@example.com'.
2026-01-29 19:44:14,733 - auth.google_auth - INFO - 36346 - MainThread [google_auth.get_authenticated_google_service:890] - [list_drive_items] Valid email 'john@example.com' provided, initiating auth flow.
2026-01-29 19:44:14,733 - auth.oauth_callback_server - INFO - 36346 - MainThread [oauth_callback_server.ensure_oauth_callback_available:274] - Minimal OAuth server is already running
2026-01-29 19:44:14,733 - auth.google_auth - INFO - 36346 - MainThread [google_auth.start_auth_flow:357] - [start_auth_flow] Initiating auth for Google Drive for 'john@example.com' with scopes for enabled tools.
2026-01-29 19:44:14,733 - auth.google_auth - ERROR - 36346 - MainThread [google_auth.start_auth_flow:428] - OAuth client credentials not found: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set. Please either:
1. Set environment variables: GOOGLE_OAUTH_CLIENT_ID and GOOGLE_OAUTH_CLIENT_SECRET
2. Ensure '/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json' file exists
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 374, in start_auth_flow
    flow = create_oauth_flow(
           ^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 308, in create_oauth_flow
    raise FileNotFoundError(
FileNotFoundError: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set
2026-01-29 19:44:14,733 - core.utils - ERROR - 36346 - MainThread [utils.wrapper:353] - An unexpected error occurred in list_drive_items: OAuth client credentials not found: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set. Please either:
1. Set environment variables: GOOGLE_OAUTH_CLIENT_ID and GOOGLE_OAUTH_CLIENT_SECRET
2. Ensure '/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json' file exists
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 374, in start_auth_flow
    flow = create_oauth_flow(
           ^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 308, in create_oauth_flow
    raise FileNotFoundError(
FileNotFoundError: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 653, in wrapper
    service, actual_user_email = await _authenticate_service(
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 215, in _authenticate_service
    return await get_authenticated_google_service(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 909, in get_authenticated_google_service
    auth_response = await start_auth_flow(
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 429, in start_auth_flow
    raise Exception(error_text)
Exception: OAuth client credentials not found: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set. Please either:
1. Set environment variables: GOOGLE_OAUTH_CLIENT_ID and GOOGLE_OAUTH_CLIENT_SECRET
2. Ensure '/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json' file exists
2026-01-29 19:44:14,858 - auth.auth_info_middleware - ERROR - 36346 - MainThread [auth_info_middleware.on_call_tool:414] - Error in on_call_tool middleware: Error calling tool 'list_drive_items': An unexpected error occurred in list_drive_items: OAuth client credentials not found: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set. Please either:
1. Set environment variables: GOOGLE_OAUTH_CLIENT_ID and GOOGLE_OAUTH_CLIENT_SECRET
2. Ensure '/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json' file exists
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 374, in start_auth_flow
    flow = create_oauth_flow(
           ^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 308, in create_oauth_flow
    raise FileNotFoundError(
FileNotFoundError: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 653, in wrapper
    service, actual_user_email = await _authenticate_service(
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 215, in _authenticate_service
    return await get_authenticated_google_service(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 909, in get_authenticated_google_service
    auth_response = await start_auth_flow(
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 429, in start_auth_flow
    raise Exception(error_text)
Exception: OAuth client credentials not found: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set. Please either:
1. Set environment variables: GOOGLE_OAUTH_CLIENT_ID and GOOGLE_OAUTH_CLIENT_SECRET
2. Ensure '/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json' file exists

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 160, in call_tool
    return await tool.run(arguments)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool.py", line 383, in run
    result = await result
             ^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 354, in wrapper
    raise Exception(message) from e
Exception: An unexpected error occurred in list_drive_items: OAuth client credentials not found: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set. Please either:
1. Set environment variables: GOOGLE_OAUTH_CLIENT_ID and GOOGLE_OAUTH_CLIENT_SECRET
2. Ensure '/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json' file exists

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/auth_info_middleware.py", line 403, in on_call_tool
    result = await call_next(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/server/server.py", line 1678, in _call_tool
    return await self._tool_manager.call_tool(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 170, in call_tool
    raise ToolError(f"Error calling tool {key!r}: {e}") from e
fastmcp.exceptions.ToolError: Error calling tool 'list_drive_items': An unexpected error occurred in list_drive_items: OAuth client credentials not found: OAuth client secrets file not found at /home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json and no environment variables set. Please either:
1. Set environment variables: GOOGLE_OAUTH_CLIENT_ID and GOOGLE_OAUTH_CLIENT_SECRET
2. Ensure '/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/client_secret.json' file exists
2026-01-29 19:44:22,198 - mcp.server.lowlevel.server - INFO - 36346 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 19:44:22,199 - auth.auth_info_middleware - INFO - 36346 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 19:44:22,199 - auth.service_decorator - INFO - 36346 - MainThread [service_decorator._get_auth_context:80] - [list_drive_items] Auth from middleware: authenticated_user=None, auth_method=None, session_id=915a9e50-edfc-4031-8600-e22765805ae0
2026-01-29 19:44:22,199 - auth.google_auth - INFO - 36346 - MainThread [google_auth.get_authenticated_google_service:868] - [list_drive_items] Attempting to get authenticated drive service. Email: 'john@example.com', Session: '915a9e50-edfc-4031-8600-e22765805ae0'
2026-01-29 19:44:22,200 - auth.google_auth - INFO - 36346 - asyncio_0 [google_auth.get_credentials:683] - [get_credentials] No credentials found for user 'john@example.com' or session '915a9e50-edfc-4031-8600-e22765805ae0'.
2026-01-29 19:44:22,201 - auth.google_auth - WARNING - 36346 - MainThread [google_auth.get_authenticated_google_service:887] - [list_drive_items] No valid credentials. Email: 'john@example.com'.
2026-01-29 19:44:22,201 - auth.google_auth - INFO - 36346 - MainThread [google_auth.get_authenticated_google_service:890] - [list_drive_items] Valid email 'john@example.com' provided, initiating auth flow.
2026-01-29 19:44:22,201 - auth.oauth_callback_server - INFO - 36346 - MainThread [oauth_callback_server.ensure_oauth_callback_available:274] - Minimal OAuth server is already running
2026-01-29 19:44:22,201 - auth.google_auth - INFO - 36346 - MainThread [google_auth.start_auth_flow:357] - [start_auth_flow] Initiating auth for Google Drive for 'john@example.com' with scopes for enabled tools.
2026-01-29 19:44:22,203 - auth.google_auth - INFO - 36346 - MainThread [google_auth.start_auth_flow:393] - Auth flow started for Google Drive for 'john@example.com'. State: 40573509... Advise user to visit: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=40573509534834622cdf4631ae95aa3d&access_type=offline&prompt=consent
2026-01-29 19:44:22,203 - auth.service_decorator - ERROR - 36346 - MainThread [service_decorator.wrapper:664] - [list_drive_items] GoogleAuthenticationError during authentication. Method=none, User=none, Service=drive vv3, MCPSessionID=915a9e50-edfc-4031-8600-e22765805ae0: **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'john@example.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=40573509534834622cdf4631ae95aa3d&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=40573509534834622cdf4631ae95aa3d&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'john@example.com' was provided, it must match the authenticated account.
2026-01-29 19:44:22,246 - auth.auth_info_middleware - ERROR - 36346 - MainThread [auth_info_middleware.on_call_tool:414] - Error in on_call_tool middleware: Error calling tool 'list_drive_items': **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'john@example.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=40573509534834622cdf4631ae95aa3d&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=40573509534834622cdf4631ae95aa3d&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'john@example.com' was provided, it must match the authenticated account.
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 160, in call_tool
    return await tool.run(arguments)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool.py", line 383, in run
    result = await result
             ^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 653, in wrapper
    service, actual_user_email = await _authenticate_service(
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 215, in _authenticate_service
    return await get_authenticated_google_service(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 916, in get_authenticated_google_service
    raise GoogleAuthenticationError(auth_response)
auth.google_auth.GoogleAuthenticationError: **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'john@example.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=40573509534834622cdf4631ae95aa3d&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=40573509534834622cdf4631ae95aa3d&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'john@example.com' was provided, it must match the authenticated account.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/auth_info_middleware.py", line 403, in on_call_tool
    result = await call_next(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/server/server.py", line 1678, in _call_tool
    return await self._tool_manager.call_tool(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 170, in call_tool
    raise ToolError(f"Error calling tool {key!r}: {e}") from e
fastmcp.exceptions.ToolError: Error calling tool 'list_drive_items': **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'john@example.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=40573509534834622cdf4631ae95aa3d&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=40573509534834622cdf4631ae95aa3d&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'john@example.com' was provided, it must match the authenticated account.
2026-01-29 19:46:06,024 - auth.scopes - INFO - 37327 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-29 19:46:06,062 - core.utils - INFO - 37327 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-29 19:46:06,062 - core.server - INFO - 37327 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 19:46:06,063 - auth.oauth_callback_server - INFO - 37327 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8000
2026-01-29 19:46:06,075 - auth.oauth_callback_server - INFO - 37327 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 19:46:06,075 - auth.oauth_callback_server - ERROR - 37327 - MainThread [oauth_callback_server.start:159] - Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:46:06,075 - auth.oauth_callback_server - ERROR - 37327 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8000: Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:46:06,140 - docket.worker - INFO - 37327 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#37327' with the following tasks:
2026-01-29 19:46:06,140 - docket.worker - INFO - 37327 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 19:46:06,140 - docket.worker - INFO - 37327 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 19:46:06,140 - docket.worker - INFO - 37327 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 19:46:06,148 - mcp.server.lowlevel.server - INFO - 37327 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-29 19:46:10,523 - auth.scopes - INFO - 37333 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-29 19:46:10,569 - core.utils - INFO - 37333 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-29 19:46:10,569 - core.server - INFO - 37333 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 19:46:10,570 - auth.oauth_callback_server - INFO - 37333 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8000
2026-01-29 19:46:10,582 - auth.oauth_callback_server - INFO - 37333 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 19:46:10,583 - auth.oauth_callback_server - ERROR - 37333 - MainThread [oauth_callback_server.start:159] - Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:46:10,583 - auth.oauth_callback_server - ERROR - 37333 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8000: Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:46:10,656 - docket.worker - INFO - 37333 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#37333' with the following tasks:
2026-01-29 19:46:10,657 - docket.worker - INFO - 37333 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 19:46:10,657 - docket.worker - INFO - 37333 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 19:46:10,657 - docket.worker - INFO - 37333 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 19:46:10,665 - mcp.server.lowlevel.server - INFO - 37333 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-29 19:47:13,625 - auth.scopes - INFO - 37349 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-29 19:47:13,674 - core.utils - INFO - 37349 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-29 19:47:13,674 - core.server - INFO - 37349 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 19:47:13,675 - auth.oauth_callback_server - INFO - 37349 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8000
2026-01-29 19:47:13,690 - auth.oauth_callback_server - INFO - 37349 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 19:47:13,691 - auth.oauth_callback_server - ERROR - 37349 - MainThread [oauth_callback_server.start:159] - Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:47:13,691 - auth.oauth_callback_server - ERROR - 37349 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8000: Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:47:13,775 - docket.worker - INFO - 37349 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#37349' with the following tasks:
2026-01-29 19:47:13,775 - docket.worker - INFO - 37349 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 19:47:13,776 - docket.worker - INFO - 37349 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 19:47:13,776 - docket.worker - INFO - 37349 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 19:47:13,785 - mcp.server.lowlevel.server - INFO - 37349 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-29 19:49:33,187 - mcp.server.lowlevel.server - INFO - 36346 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 19:49:33,188 - auth.auth_info_middleware - INFO - 36346 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 19:49:33,188 - auth.service_decorator - INFO - 36346 - MainThread [service_decorator._get_auth_context:80] - [list_drive_items] Auth from middleware: authenticated_user=None, auth_method=None, session_id=915a9e50-edfc-4031-8600-e22765805ae0
2026-01-29 19:49:33,189 - auth.google_auth - INFO - 36346 - MainThread [google_auth.get_authenticated_google_service:868] - [list_drive_items] Attempting to get authenticated drive service. Email: 'johnhenry.bradley@gmail.com', Session: '915a9e50-edfc-4031-8600-e22765805ae0'
2026-01-29 19:49:33,189 - auth.google_auth - INFO - 36346 - asyncio_0 [google_auth.get_credentials:683] - [get_credentials] No credentials found for user 'johnhenry.bradley@gmail.com' or session '915a9e50-edfc-4031-8600-e22765805ae0'.
2026-01-29 19:49:33,190 - auth.google_auth - WARNING - 36346 - MainThread [google_auth.get_authenticated_google_service:887] - [list_drive_items] No valid credentials. Email: 'johnhenry.bradley@gmail.com'.
2026-01-29 19:49:33,190 - auth.google_auth - INFO - 36346 - MainThread [google_auth.get_authenticated_google_service:890] - [list_drive_items] Valid email 'johnhenry.bradley@gmail.com' provided, initiating auth flow.
2026-01-29 19:49:33,190 - auth.oauth_callback_server - INFO - 36346 - MainThread [oauth_callback_server.ensure_oauth_callback_available:274] - Minimal OAuth server is already running
2026-01-29 19:49:33,191 - auth.google_auth - INFO - 36346 - MainThread [google_auth.start_auth_flow:357] - [start_auth_flow] Initiating auth for Google Drive for 'johnhenry.bradley@gmail.com' with scopes for enabled tools.
2026-01-29 19:49:33,192 - auth.google_auth - INFO - 36346 - MainThread [google_auth.start_auth_flow:393] - Auth flow started for Google Drive for 'johnhenry.bradley@gmail.com'. State: 2972f87f... Advise user to visit: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=2972f87f41167d384be89c52895aff0f&access_type=offline&prompt=consent
2026-01-29 19:49:33,192 - auth.service_decorator - ERROR - 36346 - MainThread [service_decorator.wrapper:664] - [list_drive_items] GoogleAuthenticationError during authentication. Method=none, User=none, Service=drive vv3, MCPSessionID=915a9e50-edfc-4031-8600-e22765805ae0: **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'johnhenry.bradley@gmail.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=2972f87f41167d384be89c52895aff0f&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=2972f87f41167d384be89c52895aff0f&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'johnhenry.bradley@gmail.com' was provided, it must match the authenticated account.
2026-01-29 19:49:33,293 - auth.auth_info_middleware - ERROR - 36346 - MainThread [auth_info_middleware.on_call_tool:414] - Error in on_call_tool middleware: Error calling tool 'list_drive_items': **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'johnhenry.bradley@gmail.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=2972f87f41167d384be89c52895aff0f&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=2972f87f41167d384be89c52895aff0f&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'johnhenry.bradley@gmail.com' was provided, it must match the authenticated account.
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 160, in call_tool
    return await tool.run(arguments)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool.py", line 383, in run
    result = await result
             ^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 653, in wrapper
    service, actual_user_email = await _authenticate_service(
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 215, in _authenticate_service
    return await get_authenticated_google_service(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 916, in get_authenticated_google_service
    raise GoogleAuthenticationError(auth_response)
auth.google_auth.GoogleAuthenticationError: **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'johnhenry.bradley@gmail.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=2972f87f41167d384be89c52895aff0f&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=2972f87f41167d384be89c52895aff0f&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'johnhenry.bradley@gmail.com' was provided, it must match the authenticated account.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/auth_info_middleware.py", line 403, in on_call_tool
    result = await call_next(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/server/server.py", line 1678, in _call_tool
    return await self._tool_manager.call_tool(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 170, in call_tool
    raise ToolError(f"Error calling tool {key!r}: {e}") from e
fastmcp.exceptions.ToolError: Error calling tool 'list_drive_items': **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'johnhenry.bradley@gmail.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=2972f87f41167d384be89c52895aff0f&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Foauth2callback&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&state=2972f87f41167d384be89c52895aff0f&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'johnhenry.bradley@gmail.com' was provided, it must match the authenticated account.
2026-01-29 19:53:27,385 - auth.scopes - INFO - 38328 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['gmail', 'drive', 'calendar', 'docs', 'sheets', 'chat', 'forms', 'slides', 'tasks', 'search', 'appscript']
2026-01-29 19:53:27,553 - core.utils - INFO - 38328 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-29 19:53:27,553 - core.server - INFO - 38328 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 19:53:27,553 - auth.oauth_callback_server - INFO - 38328 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8000
2026-01-29 19:53:27,568 - auth.oauth_callback_server - INFO - 38328 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 19:53:27,568 - auth.oauth_callback_server - ERROR - 38328 - MainThread [oauth_callback_server.start:159] - Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:53:27,568 - auth.oauth_callback_server - ERROR - 38328 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8000: Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:53:27,601 - docket.worker - INFO - 38328 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#38328' with the following tasks:
2026-01-29 19:53:27,601 - docket.worker - INFO - 38328 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 19:53:27,601 - docket.worker - INFO - 38328 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 19:53:27,601 - docket.worker - INFO - 38328 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 19:53:27,611 - mcp.server.lowlevel.server - INFO - 38328 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-29 19:57:12,907 - auth.scopes - INFO - 38544 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-29 19:57:12,948 - core.utils - INFO - 38544 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-29 19:57:12,948 - core.server - INFO - 38544 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 19:57:12,949 - auth.oauth_callback_server - INFO - 38544 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8000
2026-01-29 19:57:12,961 - auth.oauth_callback_server - INFO - 38544 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 19:57:13,063 - auth.oauth_callback_server - INFO - 38544 - MainThread [oauth_callback_server.start:192] - Minimal OAuth server started on localhost:8000
2026-01-29 19:57:13,064 - auth.oauth_callback_server - INFO - 38544 - MainThread [oauth_callback_server.ensure_oauth_callback_available:264] - Minimal OAuth server successfully started on http://localhost:8000
2026-01-29 19:57:13,101 - docket.worker - INFO - 38544 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#38544' with the following tasks:
2026-01-29 19:57:13,101 - docket.worker - INFO - 38544 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 19:57:13,101 - docket.worker - INFO - 38544 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 19:57:13,101 - docket.worker - INFO - 38544 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 19:57:13,111 - mcp.server.lowlevel.server - INFO - 38544 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-29 19:59:29,572 - auth.scopes - INFO - 38833 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-29 19:59:29,628 - core.utils - INFO - 38833 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-29 19:59:29,628 - core.server - INFO - 38833 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 19:59:29,628 - auth.oauth_callback_server - INFO - 38833 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8000
2026-01-29 19:59:29,642 - auth.oauth_callback_server - INFO - 38833 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 19:59:29,642 - auth.oauth_callback_server - ERROR - 38833 - MainThread [oauth_callback_server.start:159] - Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:59:29,642 - auth.oauth_callback_server - ERROR - 38833 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8000: Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 19:59:29,712 - docket.worker - INFO - 38833 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#38833' with the following tasks:
2026-01-29 19:59:29,712 - docket.worker - INFO - 38833 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 19:59:29,712 - docket.worker - INFO - 38833 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 19:59:29,712 - docket.worker - INFO - 38833 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 19:59:29,721 - mcp.server.lowlevel.server - INFO - 38833 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-29 20:00:06,583 - auth.scopes - INFO - 39136 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-29 20:00:06,640 - core.utils - INFO - 39136 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-29 20:00:06,640 - core.server - INFO - 39136 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 20:00:06,640 - auth.oauth_callback_server - INFO - 39136 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8000
2026-01-29 20:00:06,656 - auth.oauth_callback_server - INFO - 39136 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 20:00:06,657 - auth.oauth_callback_server - ERROR - 39136 - MainThread [oauth_callback_server.start:159] - Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 20:00:06,657 - auth.oauth_callback_server - ERROR - 39136 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8000: Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 20:00:06,737 - docket.worker - INFO - 39136 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#39136' with the following tasks:
2026-01-29 20:00:06,737 - docket.worker - INFO - 39136 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 20:00:06,737 - docket.worker - INFO - 39136 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 20:00:06,738 - docket.worker - INFO - 39136 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 20:00:06,748 - mcp.server.lowlevel.server - INFO - 39136 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-29 20:00:21,362 - mcp.server.lowlevel.server - INFO - 39136 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 20:00:21,363 - auth.auth_info_middleware - INFO - 39136 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 20:00:21,363 - auth.service_decorator - INFO - 39136 - MainThread [service_decorator._get_auth_context:80] - [search_drive_files] Auth from middleware: authenticated_user=None, auth_method=None, session_id=0ae4248a-2e65-4570-811c-901521721813
2026-01-29 20:00:21,364 - auth.google_auth - INFO - 39136 - MainThread [google_auth.get_authenticated_google_service:868] - [search_drive_files] Attempting to get authenticated drive service. Email: 'john@gmail.com', Session: '0ae4248a-2e65-4570-811c-901521721813'
2026-01-29 20:00:21,366 - auth.credential_store - INFO - 39136 - asyncio_0 [credential_store.__init__:111] - Using default credentials directory: /home/john/.google_workspace_mcp/credentials
2026-01-29 20:00:21,367 - auth.credential_store - INFO - 39136 - asyncio_0 [credential_store.__init__:114] - LocalDirectoryCredentialStore initialized with base_dir: /home/john/.google_workspace_mcp/credentials
2026-01-29 20:00:21,367 - auth.credential_store - INFO - 39136 - asyncio_0 [credential_store.get_credential_store:249] - Initialized credential store: LocalDirectoryCredentialStore
2026-01-29 20:00:21,367 - auth.google_auth - INFO - 39136 - asyncio_0 [google_auth.get_credentials:683] - [get_credentials] No credentials found for user 'john@gmail.com' or session '0ae4248a-2e65-4570-811c-901521721813'.
2026-01-29 20:00:21,368 - auth.google_auth - WARNING - 39136 - MainThread [google_auth.get_authenticated_google_service:887] - [search_drive_files] No valid credentials. Email: 'john@gmail.com'.
2026-01-29 20:00:21,368 - auth.google_auth - INFO - 39136 - MainThread [google_auth.get_authenticated_google_service:890] - [search_drive_files] Valid email 'john@gmail.com' provided, initiating auth flow.
2026-01-29 20:00:21,368 - auth.oauth_callback_server - INFO - 39136 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 20:00:21,368 - auth.oauth_callback_server - ERROR - 39136 - MainThread [oauth_callback_server.start:159] - Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 20:00:21,368 - auth.oauth_callback_server - ERROR - 39136 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8000: Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 20:00:21,368 - auth.service_decorator - ERROR - 39136 - MainThread [service_decorator.wrapper:664] - [search_drive_files] GoogleAuthenticationError during authentication. Method=none, User=none, Service=drive vv3, MCPSessionID=0ae4248a-2e65-4570-811c-901521721813: Cannot initiate OAuth flow - callback server unavailable (Port 8000 is already in use on localhost. Cannot start minimal OAuth server.)
2026-01-29 20:00:21,437 - auth.auth_info_middleware - ERROR - 39136 - MainThread [auth_info_middleware.on_call_tool:414] - Error in on_call_tool middleware: Error calling tool 'search_drive_files': Cannot initiate OAuth flow - callback server unavailable (Port 8000 is already in use on localhost. Cannot start minimal OAuth server.)
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 160, in call_tool
    return await tool.run(arguments)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool.py", line 383, in run
    result = await result
             ^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 653, in wrapper
    service, actual_user_email = await _authenticate_service(
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 215, in _authenticate_service
    return await get_authenticated_google_service(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 904, in get_authenticated_google_service
    raise GoogleAuthenticationError(
auth.google_auth.GoogleAuthenticationError: Cannot initiate OAuth flow - callback server unavailable (Port 8000 is already in use on localhost. Cannot start minimal OAuth server.)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/auth_info_middleware.py", line 403, in on_call_tool
    result = await call_next(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/server/server.py", line 1678, in _call_tool
    return await self._tool_manager.call_tool(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 170, in call_tool
    raise ToolError(f"Error calling tool {key!r}: {e}") from e
fastmcp.exceptions.ToolError: Error calling tool 'search_drive_files': Cannot initiate OAuth flow - callback server unavailable (Port 8000 is already in use on localhost. Cannot start minimal OAuth server.)
2026-01-29 20:00:27,340 - mcp.server.lowlevel.server - INFO - 39136 - MainThread [server._handle_request:720] - Processing request of type ListResourcesRequest
2026-01-29 20:00:38,327 - mcp.server.lowlevel.server - INFO - 39136 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 20:00:38,327 - auth.auth_info_middleware - INFO - 39136 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 20:00:38,328 - auth.service_decorator - INFO - 39136 - MainThread [service_decorator._get_auth_context:80] - [search_drive_files] Auth from middleware: authenticated_user=None, auth_method=None, session_id=0ae4248a-2e65-4570-811c-901521721813
2026-01-29 20:00:38,328 - auth.google_auth - INFO - 39136 - MainThread [google_auth.get_authenticated_google_service:868] - [search_drive_files] Attempting to get authenticated drive service. Email: 'john@gmail.com', Session: '0ae4248a-2e65-4570-811c-901521721813'
2026-01-29 20:00:38,328 - auth.google_auth - INFO - 39136 - asyncio_0 [google_auth.get_credentials:683] - [get_credentials] No credentials found for user 'john@gmail.com' or session '0ae4248a-2e65-4570-811c-901521721813'.
2026-01-29 20:00:38,328 - auth.google_auth - WARNING - 39136 - MainThread [google_auth.get_authenticated_google_service:887] - [search_drive_files] No valid credentials. Email: 'john@gmail.com'.
2026-01-29 20:00:38,328 - auth.google_auth - INFO - 39136 - MainThread [google_auth.get_authenticated_google_service:890] - [search_drive_files] Valid email 'john@gmail.com' provided, initiating auth flow.
2026-01-29 20:00:38,328 - auth.oauth_callback_server - INFO - 39136 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 20:00:38,328 - auth.oauth_callback_server - ERROR - 39136 - MainThread [oauth_callback_server.start:159] - Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 20:00:38,329 - auth.oauth_callback_server - ERROR - 39136 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8000: Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 20:00:38,329 - auth.service_decorator - ERROR - 39136 - MainThread [service_decorator.wrapper:664] - [search_drive_files] GoogleAuthenticationError during authentication. Method=none, User=none, Service=drive vv3, MCPSessionID=0ae4248a-2e65-4570-811c-901521721813: Cannot initiate OAuth flow - callback server unavailable (Port 8000 is already in use on localhost. Cannot start minimal OAuth server.)
2026-01-29 20:00:38,373 - auth.auth_info_middleware - ERROR - 39136 - MainThread [auth_info_middleware.on_call_tool:414] - Error in on_call_tool middleware: Error calling tool 'search_drive_files': Cannot initiate OAuth flow - callback server unavailable (Port 8000 is already in use on localhost. Cannot start minimal OAuth server.)
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 160, in call_tool
    return await tool.run(arguments)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool.py", line 383, in run
    result = await result
             ^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 653, in wrapper
    service, actual_user_email = await _authenticate_service(
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 215, in _authenticate_service
    return await get_authenticated_google_service(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 904, in get_authenticated_google_service
    raise GoogleAuthenticationError(
auth.google_auth.GoogleAuthenticationError: Cannot initiate OAuth flow - callback server unavailable (Port 8000 is already in use on localhost. Cannot start minimal OAuth server.)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/auth_info_middleware.py", line 403, in on_call_tool
    result = await call_next(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/server/server.py", line 1678, in _call_tool
    return await self._tool_manager.call_tool(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 170, in call_tool
    raise ToolError(f"Error calling tool {key!r}: {e}") from e
fastmcp.exceptions.ToolError: Error calling tool 'search_drive_files': Cannot initiate OAuth flow - callback server unavailable (Port 8000 is already in use on localhost. Cannot start minimal OAuth server.)
2026-01-29 20:00:41,242 - mcp.server.lowlevel.server - INFO - 39136 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 20:00:41,242 - auth.auth_info_middleware - INFO - 39136 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 20:00:41,243 - auth.service_decorator - INFO - 39136 - MainThread [service_decorator._get_auth_context:80] - [list_drive_items] Auth from middleware: authenticated_user=None, auth_method=None, session_id=0ae4248a-2e65-4570-811c-901521721813
2026-01-29 20:00:41,243 - auth.google_auth - INFO - 39136 - MainThread [google_auth.get_authenticated_google_service:868] - [list_drive_items] Attempting to get authenticated drive service. Email: 'john@gmail.com', Session: '0ae4248a-2e65-4570-811c-901521721813'
2026-01-29 20:00:41,243 - auth.google_auth - INFO - 39136 - asyncio_0 [google_auth.get_credentials:683] - [get_credentials] No credentials found for user 'john@gmail.com' or session '0ae4248a-2e65-4570-811c-901521721813'.
2026-01-29 20:00:41,243 - auth.google_auth - WARNING - 39136 - MainThread [google_auth.get_authenticated_google_service:887] - [list_drive_items] No valid credentials. Email: 'john@gmail.com'.
2026-01-29 20:00:41,243 - auth.google_auth - INFO - 39136 - MainThread [google_auth.get_authenticated_google_service:890] - [list_drive_items] Valid email 'john@gmail.com' provided, initiating auth flow.
2026-01-29 20:00:41,243 - auth.oauth_callback_server - INFO - 39136 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 20:00:41,243 - auth.oauth_callback_server - ERROR - 39136 - MainThread [oauth_callback_server.start:159] - Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 20:00:41,244 - auth.oauth_callback_server - ERROR - 39136 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8000: Port 8000 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 20:00:41,244 - auth.service_decorator - ERROR - 39136 - MainThread [service_decorator.wrapper:664] - [list_drive_items] GoogleAuthenticationError during authentication. Method=none, User=none, Service=drive vv3, MCPSessionID=0ae4248a-2e65-4570-811c-901521721813: Cannot initiate OAuth flow - callback server unavailable (Port 8000 is already in use on localhost. Cannot start minimal OAuth server.)
2026-01-29 20:00:41,293 - auth.auth_info_middleware - ERROR - 39136 - MainThread [auth_info_middleware.on_call_tool:414] - Error in on_call_tool middleware: Error calling tool 'list_drive_items': Cannot initiate OAuth flow - callback server unavailable (Port 8000 is already in use on localhost. Cannot start minimal OAuth server.)
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 160, in call_tool
    return await tool.run(arguments)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool.py", line 383, in run
    result = await result
             ^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 653, in wrapper
    service, actual_user_email = await _authenticate_service(
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 215, in _authenticate_service
    return await get_authenticated_google_service(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 904, in get_authenticated_google_service
    raise GoogleAuthenticationError(
auth.google_auth.GoogleAuthenticationError: Cannot initiate OAuth flow - callback server unavailable (Port 8000 is already in use on localhost. Cannot start minimal OAuth server.)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/auth_info_middleware.py", line 403, in on_call_tool
    result = await call_next(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/server/server.py", line 1678, in _call_tool
    return await self._tool_manager.call_tool(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 170, in call_tool
    raise ToolError(f"Error calling tool {key!r}: {e}") from e
fastmcp.exceptions.ToolError: Error calling tool 'list_drive_items': Cannot initiate OAuth flow - callback server unavailable (Port 8000 is already in use on localhost. Cannot start minimal OAuth server.)
2026-01-29 20:02:17,604 - auth.scopes - INFO - 39615 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-29 20:02:17,647 - core.utils - INFO - 39615 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-29 20:02:17,647 - core.server - INFO - 39615 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 20:02:17,648 - auth.oauth_callback_server - INFO - 39615 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8081
2026-01-29 20:02:17,659 - auth.oauth_callback_server - INFO - 39615 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 20:02:17,760 - auth.oauth_callback_server - INFO - 39615 - MainThread [oauth_callback_server.start:192] - Minimal OAuth server started on localhost:8081
2026-01-29 20:02:17,761 - auth.oauth_callback_server - INFO - 39615 - MainThread [oauth_callback_server.ensure_oauth_callback_available:264] - Minimal OAuth server successfully started on http://localhost:8081
2026-01-29 20:02:17,796 - docket.worker - INFO - 39615 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#39615' with the following tasks:
2026-01-29 20:02:17,796 - docket.worker - INFO - 39615 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 20:02:17,796 - docket.worker - INFO - 39615 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 20:02:17,796 - docket.worker - INFO - 39615 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 20:02:17,803 - mcp.server.lowlevel.server - INFO - 39615 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-29 20:02:54,568 - auth.scopes - INFO - 39961 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-29 20:02:54,624 - core.utils - INFO - 39961 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-29 20:02:54,624 - core.server - INFO - 39961 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 20:02:54,624 - auth.oauth_callback_server - INFO - 39961 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8081
2026-01-29 20:02:54,644 - auth.oauth_callback_server - INFO - 39961 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 20:02:54,644 - auth.oauth_callback_server - ERROR - 39961 - MainThread [oauth_callback_server.start:159] - Port 8081 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 20:02:54,644 - auth.oauth_callback_server - ERROR - 39961 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8081: Port 8081 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 20:02:54,721 - docket.worker - INFO - 39961 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#39961' with the following tasks:
2026-01-29 20:02:54,721 - docket.worker - INFO - 39961 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 20:02:54,721 - docket.worker - INFO - 39961 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 20:02:54,721 - docket.worker - INFO - 39961 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 20:02:54,730 - mcp.server.lowlevel.server - INFO - 39961 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-29 20:02:58,666 - auth.scopes - INFO - 39992 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-29 20:02:58,712 - core.utils - INFO - 39992 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-29 20:02:58,712 - core.server - INFO - 39992 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 20:02:58,712 - auth.oauth_callback_server - INFO - 39992 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8081
2026-01-29 20:02:58,725 - auth.oauth_callback_server - INFO - 39992 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 20:02:58,726 - auth.oauth_callback_server - ERROR - 39992 - MainThread [oauth_callback_server.start:159] - Port 8081 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 20:02:58,726 - auth.oauth_callback_server - ERROR - 39992 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8081: Port 8081 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-29 20:02:58,801 - docket.worker - INFO - 39992 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#39992' with the following tasks:
2026-01-29 20:02:58,802 - docket.worker - INFO - 39992 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 20:02:58,802 - docket.worker - INFO - 39992 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 20:02:58,802 - docket.worker - INFO - 39992 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 20:02:58,812 - mcp.server.lowlevel.server - INFO - 39992 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-29 20:05:08,179 - mcp.server.lowlevel.server - INFO - 39615 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 20:05:08,180 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 20:05:08,180 - auth.service_decorator - INFO - 39615 - MainThread [service_decorator._get_auth_context:80] - [search_drive_files] Auth from middleware: authenticated_user=None, auth_method=None, session_id=a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:05:08,180 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:868] - [search_drive_files] Attempting to get authenticated drive service. Email: 'antigravity-worker@ipb-app-485813.iam.gserviceaccount.com', Session: 'a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c'
2026-01-29 20:05:08,181 - auth.credential_store - INFO - 39615 - asyncio_0 [credential_store.__init__:111] - Using default credentials directory: /home/john/.google_workspace_mcp/credentials
2026-01-29 20:05:08,181 - auth.credential_store - INFO - 39615 - asyncio_0 [credential_store.__init__:114] - LocalDirectoryCredentialStore initialized with base_dir: /home/john/.google_workspace_mcp/credentials
2026-01-29 20:05:08,181 - auth.credential_store - INFO - 39615 - asyncio_0 [credential_store.get_credential_store:249] - Initialized credential store: LocalDirectoryCredentialStore
2026-01-29 20:05:08,182 - auth.google_auth - INFO - 39615 - asyncio_0 [google_auth.get_credentials:683] - [get_credentials] No credentials found for user 'antigravity-worker@ipb-app-485813.iam.gserviceaccount.com' or session 'a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c'.
2026-01-29 20:05:08,182 - auth.google_auth - WARNING - 39615 - MainThread [google_auth.get_authenticated_google_service:887] - [search_drive_files] No valid credentials. Email: 'antigravity-worker@ipb-app-485813.iam.gserviceaccount.com'.
2026-01-29 20:05:08,182 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:890] - [search_drive_files] Valid email 'antigravity-worker@ipb-app-485813.iam.gserviceaccount.com' provided, initiating auth flow.
2026-01-29 20:05:08,183 - auth.oauth_callback_server - INFO - 39615 - MainThread [oauth_callback_server.ensure_oauth_callback_available:274] - Minimal OAuth server is already running
2026-01-29 20:05:08,183 - auth.google_auth - INFO - 39615 - MainThread [google_auth.start_auth_flow:357] - [start_auth_flow] Initiating auth for Google Drive for 'antigravity-worker@ipb-app-485813.iam.gserviceaccount.com' with scopes for enabled tools.
2026-01-29 20:05:08,183 - auth.google_auth - WARNING - 39615 - MainThread [google_auth.start_auth_flow:367] - OAUTHLIB_INSECURE_TRANSPORT not set. Setting it for localhost/local development.
2026-01-29 20:05:08,184 - auth.google_auth - INFO - 39615 - MainThread [google_auth.start_auth_flow:393] - Auth flow started for Google Drive for 'antigravity-worker@ipb-app-485813.iam.gserviceaccount.com'. State: 3b334365... Advise user to visit: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=3b334365f1d43f1f2730e2e0e83fc6d4&access_type=offline&prompt=consent
2026-01-29 20:05:08,184 - auth.service_decorator - ERROR - 39615 - MainThread [service_decorator.wrapper:664] - [search_drive_files] GoogleAuthenticationError during authentication. Method=none, User=none, Service=drive vv3, MCPSessionID=a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c: **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'antigravity-worker@ipb-app-485813.iam.gserviceaccount.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=3b334365f1d43f1f2730e2e0e83fc6d4&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=3b334365f1d43f1f2730e2e0e83fc6d4&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'antigravity-worker@ipb-app-485813.iam.gserviceaccount.com' was provided, it must match the authenticated account.
2026-01-29 20:05:08,252 - auth.auth_info_middleware - ERROR - 39615 - MainThread [auth_info_middleware.on_call_tool:414] - Error in on_call_tool middleware: Error calling tool 'search_drive_files': **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'antigravity-worker@ipb-app-485813.iam.gserviceaccount.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=3b334365f1d43f1f2730e2e0e83fc6d4&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=3b334365f1d43f1f2730e2e0e83fc6d4&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'antigravity-worker@ipb-app-485813.iam.gserviceaccount.com' was provided, it must match the authenticated account.
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 160, in call_tool
    return await tool.run(arguments)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool.py", line 383, in run
    result = await result
             ^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 653, in wrapper
    service, actual_user_email = await _authenticate_service(
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 215, in _authenticate_service
    return await get_authenticated_google_service(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 916, in get_authenticated_google_service
    raise GoogleAuthenticationError(auth_response)
auth.google_auth.GoogleAuthenticationError: **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'antigravity-worker@ipb-app-485813.iam.gserviceaccount.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=3b334365f1d43f1f2730e2e0e83fc6d4&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=3b334365f1d43f1f2730e2e0e83fc6d4&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'antigravity-worker@ipb-app-485813.iam.gserviceaccount.com' was provided, it must match the authenticated account.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/auth_info_middleware.py", line 403, in on_call_tool
    result = await call_next(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/server/server.py", line 1678, in _call_tool
    return await self._tool_manager.call_tool(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 170, in call_tool
    raise ToolError(f"Error calling tool {key!r}: {e}") from e
fastmcp.exceptions.ToolError: Error calling tool 'search_drive_files': **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'antigravity-worker@ipb-app-485813.iam.gserviceaccount.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=3b334365f1d43f1f2730e2e0e83fc6d4&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=3b334365f1d43f1f2730e2e0e83fc6d4&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'antigravity-worker@ipb-app-485813.iam.gserviceaccount.com' was provided, it must match the authenticated account.
2026-01-29 20:05:13,831 - mcp.server.lowlevel.server - INFO - 39615 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 20:05:13,832 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 20:05:13,832 - auth.service_decorator - INFO - 39615 - MainThread [service_decorator._get_auth_context:80] - [search_drive_files] Auth from middleware: authenticated_user=None, auth_method=None, session_id=a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:05:13,832 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:868] - [search_drive_files] Attempting to get authenticated drive service. Email: 'john@gmail.com', Session: 'a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c'
2026-01-29 20:05:13,833 - auth.google_auth - INFO - 39615 - asyncio_0 [google_auth.get_credentials:683] - [get_credentials] No credentials found for user 'john@gmail.com' or session 'a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c'.
2026-01-29 20:05:13,834 - auth.google_auth - WARNING - 39615 - MainThread [google_auth.get_authenticated_google_service:887] - [search_drive_files] No valid credentials. Email: 'john@gmail.com'.
2026-01-29 20:05:13,834 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:890] - [search_drive_files] Valid email 'john@gmail.com' provided, initiating auth flow.
2026-01-29 20:05:13,834 - auth.oauth_callback_server - INFO - 39615 - MainThread [oauth_callback_server.ensure_oauth_callback_available:274] - Minimal OAuth server is already running
2026-01-29 20:05:13,834 - auth.google_auth - INFO - 39615 - MainThread [google_auth.start_auth_flow:357] - [start_auth_flow] Initiating auth for Google Drive for 'john@gmail.com' with scopes for enabled tools.
2026-01-29 20:05:13,835 - auth.google_auth - INFO - 39615 - MainThread [google_auth.start_auth_flow:393] - Auth flow started for Google Drive for 'john@gmail.com'. State: 95c55ad7... Advise user to visit: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=95c55ad7d751d00bfa5a360b40d7943d&access_type=offline&prompt=consent
2026-01-29 20:05:13,835 - auth.service_decorator - ERROR - 39615 - MainThread [service_decorator.wrapper:664] - [search_drive_files] GoogleAuthenticationError during authentication. Method=none, User=none, Service=drive vv3, MCPSessionID=a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c: **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'john@gmail.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=95c55ad7d751d00bfa5a360b40d7943d&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=95c55ad7d751d00bfa5a360b40d7943d&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'john@gmail.com' was provided, it must match the authenticated account.
2026-01-29 20:05:13,882 - auth.auth_info_middleware - ERROR - 39615 - MainThread [auth_info_middleware.on_call_tool:414] - Error in on_call_tool middleware: Error calling tool 'search_drive_files': **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'john@gmail.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=95c55ad7d751d00bfa5a360b40d7943d&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=95c55ad7d751d00bfa5a360b40d7943d&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'john@gmail.com' was provided, it must match the authenticated account.
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 160, in call_tool
    return await tool.run(arguments)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool.py", line 383, in run
    result = await result
             ^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 653, in wrapper
    service, actual_user_email = await _authenticate_service(
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 215, in _authenticate_service
    return await get_authenticated_google_service(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 916, in get_authenticated_google_service
    raise GoogleAuthenticationError(auth_response)
auth.google_auth.GoogleAuthenticationError: **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'john@gmail.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=95c55ad7d751d00bfa5a360b40d7943d&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=95c55ad7d751d00bfa5a360b40d7943d&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'john@gmail.com' was provided, it must match the authenticated account.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/auth_info_middleware.py", line 403, in on_call_tool
    result = await call_next(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/server/server.py", line 1678, in _call_tool
    return await self._tool_manager.call_tool(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 170, in call_tool
    raise ToolError(f"Error calling tool {key!r}: {e}") from e
fastmcp.exceptions.ToolError: Error calling tool 'search_drive_files': **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'john@gmail.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=95c55ad7d751d00bfa5a360b40d7943d&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=95c55ad7d751d00bfa5a360b40d7943d&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'john@gmail.com' was provided, it must match the authenticated account.
2026-01-29 20:11:58,382 - mcp.server.lowlevel.server - INFO - 39615 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 20:11:58,383 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 20:11:58,383 - auth.service_decorator - INFO - 39615 - MainThread [service_decorator._get_auth_context:80] - [search_drive_files] Auth from middleware: authenticated_user=None, auth_method=None, session_id=a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:11:58,383 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:868] - [search_drive_files] Attempting to get authenticated drive service. Email: 'johnhenry.bradley@gmail.com', Session: 'a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c'
2026-01-29 20:11:58,384 - auth.google_auth - INFO - 39615 - asyncio_0 [google_auth.get_credentials:683] - [get_credentials] No credentials found for user 'johnhenry.bradley@gmail.com' or session 'a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c'.
2026-01-29 20:11:58,384 - auth.google_auth - WARNING - 39615 - MainThread [google_auth.get_authenticated_google_service:887] - [search_drive_files] No valid credentials. Email: 'johnhenry.bradley@gmail.com'.
2026-01-29 20:11:58,384 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:890] - [search_drive_files] Valid email 'johnhenry.bradley@gmail.com' provided, initiating auth flow.
2026-01-29 20:11:58,384 - auth.oauth_callback_server - INFO - 39615 - MainThread [oauth_callback_server.ensure_oauth_callback_available:274] - Minimal OAuth server is already running
2026-01-29 20:11:58,384 - auth.google_auth - INFO - 39615 - MainThread [google_auth.start_auth_flow:357] - [start_auth_flow] Initiating auth for Google Drive for 'johnhenry.bradley@gmail.com' with scopes for enabled tools.
2026-01-29 20:11:58,384 - auth.google_auth - INFO - 39615 - MainThread [google_auth.start_auth_flow:393] - Auth flow started for Google Drive for 'johnhenry.bradley@gmail.com'. State: f45b3a53... Advise user to visit: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=f45b3a533ebc3ba9fbc06a3e5b3b1551&access_type=offline&prompt=consent
2026-01-29 20:11:58,384 - auth.service_decorator - ERROR - 39615 - MainThread [service_decorator.wrapper:664] - [search_drive_files] GoogleAuthenticationError during authentication. Method=none, User=none, Service=drive vv3, MCPSessionID=a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c: **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'johnhenry.bradley@gmail.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=f45b3a533ebc3ba9fbc06a3e5b3b1551&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=f45b3a533ebc3ba9fbc06a3e5b3b1551&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'johnhenry.bradley@gmail.com' was provided, it must match the authenticated account.
2026-01-29 20:11:58,428 - auth.auth_info_middleware - ERROR - 39615 - MainThread [auth_info_middleware.on_call_tool:414] - Error in on_call_tool middleware: Error calling tool 'search_drive_files': **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'johnhenry.bradley@gmail.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=f45b3a533ebc3ba9fbc06a3e5b3b1551&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=f45b3a533ebc3ba9fbc06a3e5b3b1551&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'johnhenry.bradley@gmail.com' was provided, it must match the authenticated account.
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 160, in call_tool
    return await tool.run(arguments)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool.py", line 383, in run
    result = await result
             ^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 653, in wrapper
    service, actual_user_email = await _authenticate_service(
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 215, in _authenticate_service
    return await get_authenticated_google_service(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 916, in get_authenticated_google_service
    raise GoogleAuthenticationError(auth_response)
auth.google_auth.GoogleAuthenticationError: **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'johnhenry.bradley@gmail.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=f45b3a533ebc3ba9fbc06a3e5b3b1551&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=f45b3a533ebc3ba9fbc06a3e5b3b1551&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'johnhenry.bradley@gmail.com' was provided, it must match the authenticated account.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/auth_info_middleware.py", line 403, in on_call_tool
    result = await call_next(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/server/server.py", line 1678, in _call_tool
    return await self._tool_manager.call_tool(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 170, in call_tool
    raise ToolError(f"Error calling tool {key!r}: {e}") from e
fastmcp.exceptions.ToolError: Error calling tool 'search_drive_files': **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'johnhenry.bradley@gmail.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=f45b3a533ebc3ba9fbc06a3e5b3b1551&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly&state=f45b3a533ebc3ba9fbc06a3e5b3b1551&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'johnhenry.bradley@gmail.com' was provided, it must match the authenticated account.
2026-01-29 20:13:44,178 - auth.oauth_callback_server - INFO - 39615 - Thread-1 (run_server) [oauth_callback_server.oauth_callback:79] - OAuth callback: Received code (state: f45b3a533ebc3ba9fbc06a3e5b3b1551). Attempting to exchange for tokens.
2026-01-29 20:13:44,305 - auth.google_auth - INFO - 39615 - Thread-1 (run_server) [google_auth.handle_auth_callback:504] - Successfully exchanged authorization code for tokens.
2026-01-29 20:13:44,393 - auth.google_auth - INFO - 39615 - Thread-1 (run_server) [google_auth.get_user_info:778] - Successfully fetched user info: johnhenry.bradley@gmail.com
2026-01-29 20:13:44,393 - auth.google_auth - INFO - 39615 - Thread-1 (run_server) [google_auth.handle_auth_callback:513] - Identified user_google_email: johnhenry.bradley@gmail.com
2026-01-29 20:13:44,393 - auth.credential_store - INFO - 39615 - Thread-1 (run_server) [credential_store.store_credential:184] - Stored credentials for johnhenry.bradley@gmail.com to /home/john/.google_workspace_mcp/credentials/johnhenry.bradley@gmail.com.json
2026-01-29 20:13:44,393 - auth.oauth21_session_store - INFO - 39615 - Thread-1 (run_server) [oauth21_session_store.store_session:364] - Stored OAuth 2.1 session for johnhenry.bradley@gmail.com (session_id: None)
2026-01-29 20:13:44,394 - auth.oauth_callback_server - INFO - 39615 - Thread-1 (run_server) [oauth_callback_server.oauth_callback:94] - OAuth callback: Successfully authenticated user: johnhenry.bradley@gmail.com (state: f45b3a533ebc3ba9fbc06a3e5b3b1551).
2026-01-29 20:14:13,800 - mcp.server.lowlevel.server - INFO - 39615 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 20:14:13,801 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 20:14:13,801 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-29 20:14:13,801 - auth.service_decorator - INFO - 39615 - MainThread [service_decorator._get_auth_context:80] - [search_drive_files] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:14:13,801 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:868] - [search_drive_files] Attempting to get authenticated drive service. Email: 'johnhenry.bradley@gmail.com', Session: 'a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c'
2026-01-29 20:14:13,802 - auth.google_auth - WARNING - 39615 - asyncio_0 [google_auth.save_credentials_to_session:165] - Could not save credentials to session store - no user email found for session: a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:14:13,808 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:936] - [search_drive_files] Successfully authenticated drive service for user: johnhenry.bradley@gmail.com
2026-01-29 20:14:13,808 - gdrive.drive_tools - INFO - 39615 - MainThread [drive_tools.search_drive_files:75] - [search_drive_files] Invoked. Email: 'johnhenry.bradley@gmail.com', Query: 'name contains 'IPB' and mimeType = 'application/vnd.google-apps.folder''
2026-01-29 20:14:13,808 - gdrive.drive_tools - INFO - 39615 - MainThread [drive_tools.search_drive_files:85] - [search_drive_files] Using structured query as-is: 'name contains 'IPB' and mimeType = 'application/vnd.google-apps.folder''
2026-01-29 20:14:19,256 - mcp.server.lowlevel.server - INFO - 39615 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 20:14:19,257 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 20:14:19,258 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-29 20:14:19,259 - auth.service_decorator - INFO - 39615 - MainThread [service_decorator._get_auth_context:80] - [list_drive_items] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:14:19,260 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:868] - [list_drive_items] Attempting to get authenticated drive service. Email: 'johnhenry.bradley@gmail.com', Session: 'a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c'
2026-01-29 20:14:19,263 - auth.google_auth - WARNING - 39615 - asyncio_0 [google_auth.save_credentials_to_session:165] - Could not save credentials to session store - no user email found for session: a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:14:19,276 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:936] - [list_drive_items] Successfully authenticated drive service for user: johnhenry.bradley@gmail.com
2026-01-29 20:14:19,277 - gdrive.drive_tools - INFO - 39615 - MainThread [drive_tools.list_drive_items:421] - [list_drive_items] Invoked. Email: 'johnhenry.bradley@gmail.com', Folder ID: '1avFWifW9F33MrAF6EB5WaMzFJoWxLrxy'
2026-01-29 20:16:07,613 - mcp.server.lowlevel.server - INFO - 39615 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 20:16:07,614 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 20:16:07,615 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-29 20:16:07,616 - auth.service_decorator - INFO - 39615 - MainThread [service_decorator._get_auth_context:80] - [list_drive_items] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:16:07,617 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:868] - [list_drive_items] Attempting to get authenticated drive service. Email: 'johnhenry.bradley@gmail.com', Session: 'a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c'
2026-01-29 20:16:07,618 - auth.google_auth - WARNING - 39615 - asyncio_0 [google_auth.save_credentials_to_session:165] - Could not save credentials to session store - no user email found for session: a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:16:07,622 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:936] - [list_drive_items] Successfully authenticated drive service for user: johnhenry.bradley@gmail.com
2026-01-29 20:16:07,622 - gdrive.drive_tools - INFO - 39615 - MainThread [drive_tools.list_drive_items:421] - [list_drive_items] Invoked. Email: 'johnhenry.bradley@gmail.com', Folder ID: '1avFWifW9F33MrAF6EB5WaMzFJoWxLrxy'
2026-01-29 20:19:49,204 - mcp.server.lowlevel.server - INFO - 39615 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 20:19:49,205 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 20:19:49,206 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-29 20:19:49,206 - auth.service_decorator - INFO - 39615 - MainThread [service_decorator._get_auth_context:80] - [get_doc_content] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:19:49,207 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:868] - [get_doc_content] Attempting to get authenticated drive service. Email: 'johnhenry.bradley@gmail.com', Session: 'a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c'
2026-01-29 20:19:49,208 - auth.google_auth - WARNING - 39615 - asyncio_0 [google_auth.save_credentials_to_session:165] - Could not save credentials to session store - no user email found for session: a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:19:49,212 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:936] - [get_doc_content] Successfully authenticated drive service for user: johnhenry.bradley@gmail.com
2026-01-29 20:19:49,212 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:868] - [get_doc_content] Attempting to get authenticated docs service. Email: 'johnhenry.bradley@gmail.com', Session: 'a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c'
2026-01-29 20:19:49,213 - auth.google_auth - WARNING - 39615 - asyncio_0 [google_auth.save_credentials_to_session:165] - Could not save credentials to session store - no user email found for session: a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:19:49,215 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:936] - [get_doc_content] Successfully authenticated docs service for user: johnhenry.bradley@gmail.com
2026-01-29 20:19:49,216 - gdocs.docs_tools - INFO - 39615 - MainThread [docs_tools.get_doc_content:120] - [get_doc_content] Invoked. Document/File ID: '15ArLSFH_iCXJAjP3AXLS1aIwDRagqPwY641-EshGZTs' for user 'johnhenry.bradley@gmail.com'
2026-01-29 20:19:49,475 - gdocs.docs_tools - INFO - 39615 - MainThread [docs_tools.get_doc_content:138] - [get_doc_content] File 'Technical Implementation Plan IPB app' (ID: 15ArLSFH_iCXJAjP3AXLS1aIwDRagqPwY641-EshGZTs) has mimeType: 'application/vnd.google-apps.document'
2026-01-29 20:19:49,475 - gdocs.docs_tools - INFO - 39615 - MainThread [docs_tools.get_doc_content:146] - [get_doc_content] Processing as native Google Doc.
2026-01-29 20:19:49,776 - googleapiclient.http - WARNING - 39615 - asyncio_0 [http._should_retry_response:140] - Encountered 403 Forbidden with reason "PERMISSION_DENIED"
2026-01-29 20:19:49,777 - core.utils - ERROR - 39615 - MainThread [utils.wrapper:343] - API error in get_doc_content: <HttpError 403 when requesting https://docs.googleapis.com/v1/documents/15ArLSFH_iCXJAjP3AXLS1aIwDRagqPwY641-EshGZTs?includeTabsContent=true&alt=json returned "Google Docs API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.". Details: "[{'@type': 'type.googleapis.com/google.rpc.ErrorInfo', 'reason': 'SERVICE_DISABLED', 'domain': 'googleapis.com', 'metadata': {'serviceTitle': 'Google Docs API', 'activationUrl': 'https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657', 'containerInfo': '79186948657', 'service': 'docs.googleapis.com', 'consumer': 'projects/79186948657'}}, {'@type': 'type.googleapis.com/google.rpc.LocalizedMessage', 'locale': 'en-US', 'message': 'Google Docs API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.'}, {'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Google developers console API activation', 'url': 'https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657'}]}]">
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 815, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/gdocs/docs_tools.py", line 147, in get_doc_content
    doc_data = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://docs.googleapis.com/v1/documents/15ArLSFH_iCXJAjP3AXLS1aIwDRagqPwY641-EshGZTs?includeTabsContent=true&alt=json returned "Google Docs API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.". Details: "[{'@type': 'type.googleapis.com/google.rpc.ErrorInfo', 'reason': 'SERVICE_DISABLED', 'domain': 'googleapis.com', 'metadata': {'serviceTitle': 'Google Docs API', 'activationUrl': 'https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657', 'containerInfo': '79186948657', 'service': 'docs.googleapis.com', 'consumer': 'projects/79186948657'}}, {'@type': 'type.googleapis.com/google.rpc.LocalizedMessage', 'locale': 'en-US', 'message': 'Google Docs API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.'}, {'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Google developers console API activation', 'url': 'https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657'}]}]">
2026-01-29 20:19:49,874 - auth.auth_info_middleware - ERROR - 39615 - MainThread [auth_info_middleware.on_call_tool:414] - Error in on_call_tool middleware: Error calling tool 'get_doc_content': API error in get_doc_content: <HttpError 403 when requesting https://docs.googleapis.com/v1/documents/15ArLSFH_iCXJAjP3AXLS1aIwDRagqPwY641-EshGZTs?includeTabsContent=true&alt=json returned "Google Docs API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.". Details: "[{'@type': 'type.googleapis.com/google.rpc.ErrorInfo', 'reason': 'SERVICE_DISABLED', 'domain': 'googleapis.com', 'metadata': {'serviceTitle': 'Google Docs API', 'activationUrl': 'https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657', 'containerInfo': '79186948657', 'service': 'docs.googleapis.com', 'consumer': 'projects/79186948657'}}, {'@type': 'type.googleapis.com/google.rpc.LocalizedMessage', 'locale': 'en-US', 'message': 'Google Docs API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.'}, {'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Google developers console API activation', 'url': 'https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657'}]}]">. You might need to re-authenticate for user 'johnhenry.bradley@gmail.com'. LLM: Try 'start_google_auth' with the user's email and the appropriate service_name.
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 815, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/gdocs/docs_tools.py", line 147, in get_doc_content
    doc_data = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://docs.googleapis.com/v1/documents/15ArLSFH_iCXJAjP3AXLS1aIwDRagqPwY641-EshGZTs?includeTabsContent=true&alt=json returned "Google Docs API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.". Details: "[{'@type': 'type.googleapis.com/google.rpc.ErrorInfo', 'reason': 'SERVICE_DISABLED', 'domain': 'googleapis.com', 'metadata': {'serviceTitle': 'Google Docs API', 'activationUrl': 'https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657', 'containerInfo': '79186948657', 'service': 'docs.googleapis.com', 'consumer': 'projects/79186948657'}}, {'@type': 'type.googleapis.com/google.rpc.LocalizedMessage', 'locale': 'en-US', 'message': 'Google Docs API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.'}, {'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Google developers console API activation', 'url': 'https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657'}]}]">

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 160, in call_tool
    return await tool.run(arguments)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool.py", line 383, in run
    result = await result
             ^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 344, in wrapper
    raise Exception(message) from error
Exception: API error in get_doc_content: <HttpError 403 when requesting https://docs.googleapis.com/v1/documents/15ArLSFH_iCXJAjP3AXLS1aIwDRagqPwY641-EshGZTs?includeTabsContent=true&alt=json returned "Google Docs API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.". Details: "[{'@type': 'type.googleapis.com/google.rpc.ErrorInfo', 'reason': 'SERVICE_DISABLED', 'domain': 'googleapis.com', 'metadata': {'serviceTitle': 'Google Docs API', 'activationUrl': 'https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657', 'containerInfo': '79186948657', 'service': 'docs.googleapis.com', 'consumer': 'projects/79186948657'}}, {'@type': 'type.googleapis.com/google.rpc.LocalizedMessage', 'locale': 'en-US', 'message': 'Google Docs API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.'}, {'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Google developers console API activation', 'url': 'https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657'}]}]">. You might need to re-authenticate for user 'johnhenry.bradley@gmail.com'. LLM: Try 'start_google_auth' with the user's email and the appropriate service_name.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/auth_info_middleware.py", line 403, in on_call_tool
    result = await call_next(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/server/server.py", line 1678, in _call_tool
    return await self._tool_manager.call_tool(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 170, in call_tool
    raise ToolError(f"Error calling tool {key!r}: {e}") from e
fastmcp.exceptions.ToolError: Error calling tool 'get_doc_content': API error in get_doc_content: <HttpError 403 when requesting https://docs.googleapis.com/v1/documents/15ArLSFH_iCXJAjP3AXLS1aIwDRagqPwY641-EshGZTs?includeTabsContent=true&alt=json returned "Google Docs API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.". Details: "[{'@type': 'type.googleapis.com/google.rpc.ErrorInfo', 'reason': 'SERVICE_DISABLED', 'domain': 'googleapis.com', 'metadata': {'serviceTitle': 'Google Docs API', 'activationUrl': 'https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657', 'containerInfo': '79186948657', 'service': 'docs.googleapis.com', 'consumer': 'projects/79186948657'}}, {'@type': 'type.googleapis.com/google.rpc.LocalizedMessage', 'locale': 'en-US', 'message': 'Google Docs API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.'}, {'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Google developers console API activation', 'url': 'https://console.developers.google.com/apis/api/docs.googleapis.com/overview?project=79186948657'}]}]">. You might need to re-authenticate for user 'johnhenry.bradley@gmail.com'. LLM: Try 'start_google_auth' with the user's email and the appropriate service_name.
2026-01-29 20:19:57,213 - mcp.server.lowlevel.server - INFO - 39615 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 20:19:57,214 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 20:19:57,214 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-29 20:19:57,214 - auth.service_decorator - INFO - 39615 - MainThread [service_decorator._get_auth_context:80] - [get_drive_file_content] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:19:57,214 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:868] - [get_drive_file_content] Attempting to get authenticated drive service. Email: 'johnhenry.bradley@gmail.com', Session: 'a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c'
2026-01-29 20:19:57,215 - auth.google_auth - WARNING - 39615 - asyncio_0 [google_auth.save_credentials_to_session:165] - Could not save credentials to session store - no user email found for session: a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:19:57,219 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:936] - [get_drive_file_content] Successfully authenticated drive service for user: johnhenry.bradley@gmail.com
2026-01-29 20:19:57,219 - gdrive.drive_tools - INFO - 39615 - MainThread [drive_tools.get_drive_file_content:144] - [get_drive_file_content] Invoked. File ID: '15ArLSFH_iCXJAjP3AXLS1aIwDRagqPwY641-EshGZTs'
2026-01-29 20:20:09,283 - mcp.server.lowlevel.server - INFO - 39615 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 20:20:09,283 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 20:20:09,284 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-29 20:20:09,284 - auth.service_decorator - INFO - 39615 - MainThread [service_decorator._get_auth_context:80] - [read_sheet_values] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:20:09,284 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:868] - [read_sheet_values] Attempting to get authenticated sheets service. Email: 'johnhenry.bradley@gmail.com', Session: 'a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c'
2026-01-29 20:20:09,284 - auth.google_auth - WARNING - 39615 - asyncio_0 [google_auth.save_credentials_to_session:165] - Could not save credentials to session store - no user email found for session: a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:20:09,287 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:936] - [read_sheet_values] Successfully authenticated sheets service for user: johnhenry.bradley@gmail.com
2026-01-29 20:20:09,287 - gsheets.sheets_tools - INFO - 39615 - MainThread [sheets_tools.read_sheet_values:189] - [read_sheet_values] Invoked. Email: 'johnhenry.bradley@gmail.com', Spreadsheet: 1VSurdFaUDC_p52CTevrdSw-ymNkY7rJWiuZxfzYMaTg, Range: A1:Z50
2026-01-29 20:20:10,195 - googleapiclient.http - WARNING - 39615 - asyncio_0 [http._should_retry_response:140] - Encountered 403 Forbidden with reason "PERMISSION_DENIED"
2026-01-29 20:20:10,195 - core.utils - ERROR - 39615 - MainThread [utils.wrapper:343] - API error in read_sheet_values: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets/1VSurdFaUDC_p52CTevrdSw-ymNkY7rJWiuZxfzYMaTg/values/A1%3AZ50?alt=json returned "Google Sheets API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.". Details: "[{'@type': 'type.googleapis.com/google.rpc.ErrorInfo', 'reason': 'SERVICE_DISABLED', 'domain': 'googleapis.com', 'metadata': {'consumer': 'projects/79186948657', 'activationUrl': 'https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657', 'service': 'sheets.googleapis.com', 'containerInfo': '79186948657', 'serviceTitle': 'Google Sheets API'}}, {'@type': 'type.googleapis.com/google.rpc.LocalizedMessage', 'locale': 'en-US', 'message': 'Google Sheets API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.'}, {'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Google developers console API activation', 'url': 'https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657'}]}]">
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 678, in wrapper
    return await func(service, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/gsheets/sheets_tools.py", line 193, in read_sheet_values
    result = await asyncio.to_thread(
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets/1VSurdFaUDC_p52CTevrdSw-ymNkY7rJWiuZxfzYMaTg/values/A1%3AZ50?alt=json returned "Google Sheets API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.". Details: "[{'@type': 'type.googleapis.com/google.rpc.ErrorInfo', 'reason': 'SERVICE_DISABLED', 'domain': 'googleapis.com', 'metadata': {'consumer': 'projects/79186948657', 'activationUrl': 'https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657', 'service': 'sheets.googleapis.com', 'containerInfo': '79186948657', 'serviceTitle': 'Google Sheets API'}}, {'@type': 'type.googleapis.com/google.rpc.LocalizedMessage', 'locale': 'en-US', 'message': 'Google Sheets API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.'}, {'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Google developers console API activation', 'url': 'https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657'}]}]">
2026-01-29 20:20:10,333 - auth.auth_info_middleware - ERROR - 39615 - MainThread [auth_info_middleware.on_call_tool:414] - Error in on_call_tool middleware: Error calling tool 'read_sheet_values': API error in read_sheet_values: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets/1VSurdFaUDC_p52CTevrdSw-ymNkY7rJWiuZxfzYMaTg/values/A1%3AZ50?alt=json returned "Google Sheets API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.". Details: "[{'@type': 'type.googleapis.com/google.rpc.ErrorInfo', 'reason': 'SERVICE_DISABLED', 'domain': 'googleapis.com', 'metadata': {'consumer': 'projects/79186948657', 'activationUrl': 'https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657', 'service': 'sheets.googleapis.com', 'containerInfo': '79186948657', 'serviceTitle': 'Google Sheets API'}}, {'@type': 'type.googleapis.com/google.rpc.LocalizedMessage', 'locale': 'en-US', 'message': 'Google Sheets API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.'}, {'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Google developers console API activation', 'url': 'https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657'}]}]">. You might need to re-authenticate for user 'johnhenry.bradley@gmail.com'. LLM: Try 'start_google_auth' with the user's email and the appropriate service_name.
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 678, in wrapper
    return await func(service, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/gsheets/sheets_tools.py", line 193, in read_sheet_values
    result = await asyncio.to_thread(
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets/1VSurdFaUDC_p52CTevrdSw-ymNkY7rJWiuZxfzYMaTg/values/A1%3AZ50?alt=json returned "Google Sheets API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.". Details: "[{'@type': 'type.googleapis.com/google.rpc.ErrorInfo', 'reason': 'SERVICE_DISABLED', 'domain': 'googleapis.com', 'metadata': {'consumer': 'projects/79186948657', 'activationUrl': 'https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657', 'service': 'sheets.googleapis.com', 'containerInfo': '79186948657', 'serviceTitle': 'Google Sheets API'}}, {'@type': 'type.googleapis.com/google.rpc.LocalizedMessage', 'locale': 'en-US', 'message': 'Google Sheets API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.'}, {'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Google developers console API activation', 'url': 'https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657'}]}]">

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 160, in call_tool
    return await tool.run(arguments)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool.py", line 383, in run
    result = await result
             ^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 344, in wrapper
    raise Exception(message) from error
Exception: API error in read_sheet_values: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets/1VSurdFaUDC_p52CTevrdSw-ymNkY7rJWiuZxfzYMaTg/values/A1%3AZ50?alt=json returned "Google Sheets API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.". Details: "[{'@type': 'type.googleapis.com/google.rpc.ErrorInfo', 'reason': 'SERVICE_DISABLED', 'domain': 'googleapis.com', 'metadata': {'consumer': 'projects/79186948657', 'activationUrl': 'https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657', 'service': 'sheets.googleapis.com', 'containerInfo': '79186948657', 'serviceTitle': 'Google Sheets API'}}, {'@type': 'type.googleapis.com/google.rpc.LocalizedMessage', 'locale': 'en-US', 'message': 'Google Sheets API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.'}, {'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Google developers console API activation', 'url': 'https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657'}]}]">. You might need to re-authenticate for user 'johnhenry.bradley@gmail.com'. LLM: Try 'start_google_auth' with the user's email and the appropriate service_name.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/auth_info_middleware.py", line 403, in on_call_tool
    result = await call_next(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/server/server.py", line 1678, in _call_tool
    return await self._tool_manager.call_tool(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 170, in call_tool
    raise ToolError(f"Error calling tool {key!r}: {e}") from e
fastmcp.exceptions.ToolError: Error calling tool 'read_sheet_values': API error in read_sheet_values: <HttpError 403 when requesting https://sheets.googleapis.com/v4/spreadsheets/1VSurdFaUDC_p52CTevrdSw-ymNkY7rJWiuZxfzYMaTg/values/A1%3AZ50?alt=json returned "Google Sheets API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.". Details: "[{'@type': 'type.googleapis.com/google.rpc.ErrorInfo', 'reason': 'SERVICE_DISABLED', 'domain': 'googleapis.com', 'metadata': {'consumer': 'projects/79186948657', 'activationUrl': 'https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657', 'service': 'sheets.googleapis.com', 'containerInfo': '79186948657', 'serviceTitle': 'Google Sheets API'}}, {'@type': 'type.googleapis.com/google.rpc.LocalizedMessage', 'locale': 'en-US', 'message': 'Google Sheets API has not been used in project 79186948657 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.'}, {'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Google developers console API activation', 'url': 'https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=79186948657'}]}]">. You might need to re-authenticate for user 'johnhenry.bradley@gmail.com'. LLM: Try 'start_google_auth' with the user's email and the appropriate service_name.
2026-01-29 20:20:14,647 - mcp.server.lowlevel.server - INFO - 39615 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 20:20:14,647 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 20:20:14,647 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-29 20:20:14,647 - auth.service_decorator - INFO - 39615 - MainThread [service_decorator._get_auth_context:80] - [get_drive_file_content] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:20:14,647 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:868] - [get_drive_file_content] Attempting to get authenticated drive service. Email: 'johnhenry.bradley@gmail.com', Session: 'a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c'
2026-01-29 20:20:14,648 - auth.google_auth - WARNING - 39615 - asyncio_0 [google_auth.save_credentials_to_session:165] - Could not save credentials to session store - no user email found for session: a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:20:14,649 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:936] - [get_drive_file_content] Successfully authenticated drive service for user: johnhenry.bradley@gmail.com
2026-01-29 20:20:14,650 - gdrive.drive_tools - INFO - 39615 - MainThread [drive_tools.get_drive_file_content:144] - [get_drive_file_content] Invoked. File ID: '1VSurdFaUDC_p52CTevrdSw-ymNkY7rJWiuZxfzYMaTg'
2026-01-29 20:20:29,689 - mcp.server.lowlevel.server - INFO - 39615 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-29 20:20:29,690 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-29 20:20:29,690 - auth.auth_info_middleware - INFO - 39615 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-29 20:20:29,690 - auth.service_decorator - INFO - 39615 - MainThread [service_decorator._get_auth_context:80] - [list_drive_items] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:20:29,690 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:868] - [list_drive_items] Attempting to get authenticated drive service. Email: 'johnhenry.bradley@gmail.com', Session: 'a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c'
2026-01-29 20:20:29,691 - auth.google_auth - WARNING - 39615 - asyncio_0 [google_auth.save_credentials_to_session:165] - Could not save credentials to session store - no user email found for session: a03cb3e4-4cfa-418a-a10b-fd2ada7f1f1c
2026-01-29 20:20:29,694 - auth.google_auth - INFO - 39615 - MainThread [google_auth.get_authenticated_google_service:936] - [list_drive_items] Successfully authenticated drive service for user: johnhenry.bradley@gmail.com
2026-01-29 20:20:29,694 - gdrive.drive_tools - INFO - 39615 - MainThread [drive_tools.list_drive_items:421] - [list_drive_items] Invoked. Email: 'johnhenry.bradley@gmail.com', Folder ID: '1O0Gpo4mB2tjJdM3wTV1zxLlKvtgoIYHW'
2026-01-29 21:48:00,748 - auth.scopes - INFO - 56054 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-29 21:48:00,792 - core.utils - INFO - 56054 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-29 21:48:00,792 - core.server - INFO - 56054 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-29 21:48:00,792 - auth.oauth_callback_server - INFO - 56054 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8081
2026-01-29 21:48:00,806 - auth.oauth_callback_server - INFO - 56054 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-29 21:48:00,907 - auth.oauth_callback_server - INFO - 56054 - MainThread [oauth_callback_server.start:192] - Minimal OAuth server started on localhost:8081
2026-01-29 21:48:00,908 - auth.oauth_callback_server - INFO - 56054 - MainThread [oauth_callback_server.ensure_oauth_callback_available:264] - Minimal OAuth server successfully started on http://localhost:8081
2026-01-29 21:48:00,940 - docket.worker - INFO - 56054 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#56054' with the following tasks:
2026-01-29 21:48:00,940 - docket.worker - INFO - 56054 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-29 21:48:00,940 - docket.worker - INFO - 56054 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-29 21:48:00,940 - docket.worker - INFO - 56054 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-29 21:48:00,950 - mcp.server.lowlevel.server - INFO - 56054 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-30 12:08:02,573 - auth.scopes - INFO - 60108 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-30 12:08:02,618 - core.utils - INFO - 60108 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-30 12:08:02,618 - core.server - INFO - 60108 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-30 12:08:02,618 - auth.oauth_callback_server - INFO - 60108 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8081
2026-01-30 12:08:02,630 - auth.oauth_callback_server - INFO - 60108 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-30 12:08:02,732 - auth.oauth_callback_server - INFO - 60108 - MainThread [oauth_callback_server.start:192] - Minimal OAuth server started on localhost:8081
2026-01-30 12:08:02,732 - auth.oauth_callback_server - INFO - 60108 - MainThread [oauth_callback_server.ensure_oauth_callback_available:264] - Minimal OAuth server successfully started on http://localhost:8081
2026-01-30 12:08:02,783 - httpx - INFO - 60108 - MainThread [_client._send_single_request:1025] - HTTP Request: GET https://pypi.org/pypi/fastmcp/json "HTTP/1.1 200 OK"
2026-01-30 12:08:02,818 - docket.worker - INFO - 60108 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#60108' with the following tasks:
2026-01-30 12:08:02,818 - docket.worker - INFO - 60108 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-30 12:08:02,818 - docket.worker - INFO - 60108 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-30 12:08:02,818 - docket.worker - INFO - 60108 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-30 12:08:02,829 - mcp.server.lowlevel.server - INFO - 60108 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-30 12:08:09,419 - auth.scopes - INFO - 60666 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-30 12:08:09,458 - core.utils - INFO - 60666 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-30 12:08:09,458 - core.server - INFO - 60666 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-30 12:08:09,458 - auth.oauth_callback_server - INFO - 60666 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8081
2026-01-30 12:08:09,471 - auth.oauth_callback_server - INFO - 60666 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-30 12:08:09,471 - auth.oauth_callback_server - ERROR - 60666 - MainThread [oauth_callback_server.start:159] - Port 8081 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-30 12:08:09,471 - auth.oauth_callback_server - ERROR - 60666 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8081: Port 8081 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-30 12:08:09,539 - docket.worker - INFO - 60666 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#60666' with the following tasks:
2026-01-30 12:08:09,539 - docket.worker - INFO - 60666 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-30 12:08:09,539 - docket.worker - INFO - 60666 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-30 12:08:09,539 - docket.worker - INFO - 60666 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-30 12:08:09,548 - mcp.server.lowlevel.server - INFO - 60666 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-30 12:08:17,033 - auth.scopes - INFO - 60976 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-30 12:08:17,079 - core.utils - INFO - 60976 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-30 12:08:17,079 - core.server - INFO - 60976 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-30 12:08:17,079 - auth.oauth_callback_server - INFO - 60976 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8081
2026-01-30 12:08:17,093 - auth.oauth_callback_server - INFO - 60976 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-30 12:08:17,093 - auth.oauth_callback_server - ERROR - 60976 - MainThread [oauth_callback_server.start:159] - Port 8081 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-30 12:08:17,093 - auth.oauth_callback_server - ERROR - 60976 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8081: Port 8081 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-30 12:08:17,164 - docket.worker - INFO - 60976 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#60976' with the following tasks:
2026-01-30 12:08:17,164 - docket.worker - INFO - 60976 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-30 12:08:17,164 - docket.worker - INFO - 60976 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-30 12:08:17,164 - docket.worker - INFO - 60976 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-30 12:08:17,173 - mcp.server.lowlevel.server - INFO - 60976 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-30 12:09:40,553 - mcp.server.lowlevel.server - INFO - 60976 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-30 12:09:40,554 - auth.auth_info_middleware - INFO - 60976 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-30 12:09:40,555 - auth.service_decorator - INFO - 60976 - MainThread [service_decorator._get_auth_context:80] - [search_drive_files] Auth from middleware: authenticated_user=None, auth_method=None, session_id=e3608361-43f0-4103-b0ca-da37f92767ff
2026-01-30 12:09:40,555 - auth.google_auth - INFO - 60976 - MainThread [google_auth.get_authenticated_google_service:868] - [search_drive_files] Attempting to get authenticated drive service. Email: 'johnhenry.bradley@gmail.com', Session: 'e3608361-43f0-4103-b0ca-da37f92767ff'
2026-01-30 12:09:40,558 - auth.credential_store - INFO - 60976 - asyncio_0 [credential_store.__init__:111] - Using default credentials directory: /home/john/.google_workspace_mcp/credentials
2026-01-30 12:09:40,559 - auth.credential_store - INFO - 60976 - asyncio_0 [credential_store.__init__:114] - LocalDirectoryCredentialStore initialized with base_dir: /home/john/.google_workspace_mcp/credentials
2026-01-30 12:09:40,559 - auth.credential_store - INFO - 60976 - asyncio_0 [credential_store.get_credential_store:249] - Initialized credential store: LocalDirectoryCredentialStore
2026-01-30 12:09:40,559 - auth.google_auth - WARNING - 60976 - asyncio_0 [google_auth.save_credentials_to_session:165] - Could not save credentials to session store - no user email found for session: e3608361-43f0-4103-b0ca-da37f92767ff
2026-01-30 12:09:40,559 - auth.google_auth - INFO - 60976 - asyncio_0 [google_auth.get_credentials:708] - [get_credentials] Credentials expired. Attempting refresh. User: 'johnhenry.bradley@gmail.com', Session: 'e3608361-43f0-4103-b0ca-da37f92767ff'
2026-01-30 12:09:40,679 - auth.google_auth - INFO - 60976 - asyncio_0 [google_auth.get_credentials:717] - [get_credentials] Credentials refreshed successfully. User: 'johnhenry.bradley@gmail.com', Session: 'e3608361-43f0-4103-b0ca-da37f92767ff'
2026-01-30 12:09:40,680 - auth.credential_store - INFO - 60976 - asyncio_0 [credential_store.store_credential:184] - Stored credentials for johnhenry.bradley@gmail.com to /home/john/.google_workspace_mcp/credentials/johnhenry.bradley@gmail.com.json
2026-01-30 12:09:40,680 - auth.oauth21_session_store - INFO - 60976 - asyncio_0 [oauth21_session_store.store_session:347] - Created immutable session binding: e3608361-43f0-4103-b0ca-da37f92767ff -> johnhenry.bradley@gmail.com
2026-01-30 12:09:40,680 - auth.oauth21_session_store - INFO - 60976 - asyncio_0 [oauth21_session_store.store_session:360] - Stored OAuth 2.1 session for johnhenry.bradley@gmail.com (session_id: None, mcp_session_id: e3608361-43f0-4103-b0ca-da37f92767ff)
2026-01-30 12:09:40,680 - auth.oauth21_session_store - INFO - 60976 - asyncio_0 [oauth21_session_store.store_session:360] - Stored OAuth 2.1 session for johnhenry.bradley@gmail.com (session_id: None, mcp_session_id: e3608361-43f0-4103-b0ca-da37f92767ff)
2026-01-30 12:09:40,682 - auth.google_auth - INFO - 60976 - MainThread [google_auth.get_authenticated_google_service:932] - [search_drive_files] Token email: johnhenry.bradley@gmail.com
2026-01-30 12:09:40,682 - auth.google_auth - INFO - 60976 - MainThread [google_auth.get_authenticated_google_service:936] - [search_drive_files] Successfully authenticated drive service for user: johnhenry.bradley@gmail.com
2026-01-30 12:09:40,682 - gdrive.drive_tools - INFO - 60976 - MainThread [drive_tools.search_drive_files:75] - [search_drive_files] Invoked. Email: 'johnhenry.bradley@gmail.com', Query: 'IPB Lung Cancer Template'
2026-01-30 12:09:40,682 - gdrive.drive_tools - INFO - 60976 - MainThread [drive_tools.search_drive_files:92] - [search_drive_files] Reformatting free text query 'IPB Lung Cancer Template' to 'fullText contains 'IPB Lung Cancer Template''
2026-01-30 12:09:44,596 - mcp.server.lowlevel.server - INFO - 60976 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-30 12:09:44,597 - auth.auth_info_middleware - INFO - 60976 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-30 12:09:44,597 - auth.auth_info_middleware - INFO - 60976 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-30 12:09:44,597 - auth.service_decorator - INFO - 60976 - MainThread [service_decorator._get_auth_context:80] - [read_sheet_values] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=e3608361-43f0-4103-b0ca-da37f92767ff
2026-01-30 12:09:44,597 - auth.google_auth - INFO - 60976 - MainThread [google_auth.get_authenticated_google_service:868] - [read_sheet_values] Attempting to get authenticated sheets service. Email: 'johnhenry.bradley@gmail.com', Session: 'e3608361-43f0-4103-b0ca-da37f92767ff'
2026-01-30 12:09:44,598 - auth.google_auth - INFO - 60976 - asyncio_0 [google_auth.get_credentials:575] - [get_credentials] Found OAuth 2.1 credentials for MCP session e3608361-43f0-4103-b0ca-da37f92767ff
2026-01-30 12:09:44,602 - auth.google_auth - INFO - 60976 - MainThread [google_auth.get_authenticated_google_service:936] - [read_sheet_values] Successfully authenticated sheets service for user: johnhenry.bradley@gmail.com
2026-01-30 12:09:44,602 - gsheets.sheets_tools - INFO - 60976 - MainThread [sheets_tools.read_sheet_values:189] - [read_sheet_values] Invoked. Email: 'johnhenry.bradley@gmail.com', Spreadsheet: 1jZte5TaoCzmXtFeKacmzq-Sl7XuJBP5vDkyHg2mDwcQ, Range: A1:Z50
2026-01-30 12:09:46,413 - gsheets.sheets_tools - INFO - 60976 - MainThread [sheets_tools.read_sheet_values:235] - Successfully read 41 rows for johnhenry.bradley@gmail.com.
2026-01-30 12:28:29,582 - mcp.server.lowlevel.server - INFO - 60976 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-30 12:28:29,582 - auth.auth_info_middleware - INFO - 60976 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-30 12:28:29,591 - auth.auth_info_middleware - INFO - 60976 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-30 12:28:29,591 - auth.service_decorator - INFO - 60976 - MainThread [service_decorator._get_auth_context:80] - [read_sheet_values] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=e3608361-43f0-4103-b0ca-da37f92767ff
2026-01-30 12:28:29,592 - auth.google_auth - INFO - 60976 - MainThread [google_auth.get_authenticated_google_service:868] - [read_sheet_values] Attempting to get authenticated sheets service. Email: 'johnhenry.bradley@gmail.com', Session: 'e3608361-43f0-4103-b0ca-da37f92767ff'
2026-01-30 12:28:29,593 - auth.google_auth - INFO - 60976 - asyncio_0 [google_auth.get_credentials:575] - [get_credentials] Found OAuth 2.1 credentials for MCP session e3608361-43f0-4103-b0ca-da37f92767ff
2026-01-30 12:28:29,604 - auth.google_auth - INFO - 60976 - MainThread [google_auth.get_authenticated_google_service:936] - [read_sheet_values] Successfully authenticated sheets service for user: johnhenry.bradley@gmail.com
2026-01-30 12:28:29,605 - gsheets.sheets_tools - INFO - 60976 - MainThread [sheets_tools.read_sheet_values:189] - [read_sheet_values] Invoked. Email: 'johnhenry.bradley@gmail.com', Spreadsheet: 1VSurdFaUDC_p52CTevrdSw-ymNkY7rJWiuZxfzYMaTg, Range: A1:Z50
2026-01-30 12:28:31,180 - gsheets.sheets_tools - INFO - 60976 - MainThread [sheets_tools.read_sheet_values:235] - Successfully read 50 rows for johnhenry.bradley@gmail.com.
2026-01-30 12:28:47,908 - mcp.server.lowlevel.server - INFO - 60976 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-30 12:28:47,909 - auth.auth_info_middleware - INFO - 60976 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-30 12:28:47,909 - auth.auth_info_middleware - INFO - 60976 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-30 12:28:47,909 - auth.service_decorator - INFO - 60976 - MainThread [service_decorator._get_auth_context:80] - [read_sheet_values] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=e3608361-43f0-4103-b0ca-da37f92767ff
2026-01-30 12:28:47,909 - auth.google_auth - INFO - 60976 - MainThread [google_auth.get_authenticated_google_service:868] - [read_sheet_values] Attempting to get authenticated sheets service. Email: 'johnhenry.bradley@gmail.com', Session: 'e3608361-43f0-4103-b0ca-da37f92767ff'
2026-01-30 12:28:47,910 - auth.google_auth - INFO - 60976 - asyncio_0 [google_auth.get_credentials:575] - [get_credentials] Found OAuth 2.1 credentials for MCP session e3608361-43f0-4103-b0ca-da37f92767ff
2026-01-30 12:28:47,917 - auth.google_auth - INFO - 60976 - MainThread [google_auth.get_authenticated_google_service:936] - [read_sheet_values] Successfully authenticated sheets service for user: johnhenry.bradley@gmail.com
2026-01-30 12:28:47,918 - gsheets.sheets_tools - INFO - 60976 - MainThread [sheets_tools.read_sheet_values:189] - [read_sheet_values] Invoked. Email: 'johnhenry.bradley@gmail.com', Spreadsheet: 1jZte5TaoCzmXtFeKacmzq-Sl7XuJBP5vDkyHg2mDwcQ, Range: A1:C30
2026-01-30 12:28:49,269 - gsheets.sheets_tools - INFO - 60976 - MainThread [sheets_tools.read_sheet_values:235] - Successfully read 30 rows for johnhenry.bradley@gmail.com.
2026-01-30 13:18:03,156 - auth.scopes - INFO - 63695 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-30 13:18:03,158 - auth.scopes - INFO - 63694 - MainThread [scopes.set_enabled_tools:149] - Enabled tools set for scope management: ['drive', 'docs', 'sheets']
2026-01-30 13:18:03,197 - core.utils - INFO - 63695 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-30 13:18:03,198 - core.server - INFO - 63695 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-30 13:18:03,198 - auth.oauth_callback_server - INFO - 63695 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8081
2026-01-30 13:18:03,200 - core.utils - INFO - 63694 - MainThread [utils.check_credentials_directory_permissions:57] - Credentials directory permissions check passed: /home/john/.google_workspace_mcp/credentials
2026-01-30 13:18:03,200 - core.server - INFO - 63694 - MainThread [server.set_transport_mode:75] - Transport: stdio
2026-01-30 13:18:03,200 - auth.oauth_callback_server - INFO - 63694 - MainThread [oauth_callback_server.ensure_oauth_callback_available:257] - Creating minimal OAuth server instance for http://localhost:8081
2026-01-30 13:18:03,210 - auth.oauth_callback_server - INFO - 63695 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-30 13:18:03,210 - auth.oauth_callback_server - ERROR - 63695 - MainThread [oauth_callback_server.start:159] - Port 8081 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-30 13:18:03,210 - auth.oauth_callback_server - ERROR - 63695 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8081: Port 8081 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-30 13:18:03,213 - auth.oauth_callback_server - INFO - 63694 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-30 13:18:03,213 - auth.oauth_callback_server - ERROR - 63694 - MainThread [oauth_callback_server.start:159] - Port 8081 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-30 13:18:03,213 - auth.oauth_callback_server - ERROR - 63694 - MainThread [oauth_callback_server.ensure_oauth_callback_available:269] - Failed to start minimal OAuth server on http://localhost:8081: Port 8081 is already in use on localhost. Cannot start minimal OAuth server.
2026-01-30 13:18:03,280 - docket.worker - INFO - 63695 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#63695' with the following tasks:
2026-01-30 13:18:03,280 - docket.worker - INFO - 63695 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-30 13:18:03,280 - docket.worker - INFO - 63695 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-30 13:18:03,280 - docket.worker - INFO - 63695 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-30 13:18:03,282 - docket.worker - INFO - 63694 - MainThread [worker._startup_log:1097] - Starting worker 'john-NUC12WSKi5#63694' with the following tasks:
2026-01-30 13:18:03,283 - docket.worker - INFO - 63694 - MainThread [worker._startup_log:1099] - * trace(message: str, ...)
2026-01-30 13:18:03,283 - docket.worker - INFO - 63694 - MainThread [worker._startup_log:1099] - * fail(message: str, ...)
2026-01-30 13:18:03,283 - docket.worker - INFO - 63694 - MainThread [worker._startup_log:1099] - * sleep(seconds: float, ...)
2026-01-30 13:18:03,288 - mcp.server.lowlevel.server - INFO - 63695 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-30 13:18:03,290 - mcp.server.lowlevel.server - INFO - 63694 - MainThread [server._handle_request:720] - Processing request of type ListToolsRequest
2026-01-30 15:58:20,796 - mcp.server.lowlevel.server - INFO - 63695 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-30 15:58:20,796 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-30 15:58:20,796 - auth.service_decorator - INFO - 63695 - MainThread [service_decorator._get_auth_context:80] - [read_sheet_values] Auth from middleware: authenticated_user=None, auth_method=None, session_id=3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-30 15:58:20,796 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:868] - [read_sheet_values] Attempting to get authenticated sheets service. Email: 'johnhenry.bradley@gmail.com', Session: '3a811f7c-94cd-4f07-b6a3-95f866f9c22d'
2026-01-30 15:58:20,797 - auth.credential_store - INFO - 63695 - asyncio_0 [credential_store.__init__:111] - Using default credentials directory: /home/john/.google_workspace_mcp/credentials
2026-01-30 15:58:20,797 - auth.credential_store - INFO - 63695 - asyncio_0 [credential_store.__init__:114] - LocalDirectoryCredentialStore initialized with base_dir: /home/john/.google_workspace_mcp/credentials
2026-01-30 15:58:20,797 - auth.credential_store - INFO - 63695 - asyncio_0 [credential_store.get_credential_store:249] - Initialized credential store: LocalDirectoryCredentialStore
2026-01-30 15:58:20,797 - auth.google_auth - WARNING - 63695 - asyncio_0 [google_auth.save_credentials_to_session:165] - Could not save credentials to session store - no user email found for session: 3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-30 15:58:20,797 - auth.google_auth - INFO - 63695 - asyncio_0 [google_auth.get_credentials:708] - [get_credentials] Credentials expired. Attempting refresh. User: 'johnhenry.bradley@gmail.com', Session: '3a811f7c-94cd-4f07-b6a3-95f866f9c22d'
2026-01-30 15:58:20,891 - auth.google_auth - INFO - 63695 - asyncio_0 [google_auth.get_credentials:717] - [get_credentials] Credentials refreshed successfully. User: 'johnhenry.bradley@gmail.com', Session: '3a811f7c-94cd-4f07-b6a3-95f866f9c22d'
2026-01-30 15:58:20,891 - auth.credential_store - INFO - 63695 - asyncio_0 [credential_store.store_credential:184] - Stored credentials for johnhenry.bradley@gmail.com to /home/john/.google_workspace_mcp/credentials/johnhenry.bradley@gmail.com.json
2026-01-30 15:58:20,892 - auth.oauth21_session_store - INFO - 63695 - asyncio_0 [oauth21_session_store.store_session:347] - Created immutable session binding: 3a811f7c-94cd-4f07-b6a3-95f866f9c22d -> johnhenry.bradley@gmail.com
2026-01-30 15:58:20,892 - auth.oauth21_session_store - INFO - 63695 - asyncio_0 [oauth21_session_store.store_session:360] - Stored OAuth 2.1 session for johnhenry.bradley@gmail.com (session_id: None, mcp_session_id: 3a811f7c-94cd-4f07-b6a3-95f866f9c22d)
2026-01-30 15:58:20,892 - auth.oauth21_session_store - INFO - 63695 - asyncio_0 [oauth21_session_store.store_session:360] - Stored OAuth 2.1 session for johnhenry.bradley@gmail.com (session_id: None, mcp_session_id: 3a811f7c-94cd-4f07-b6a3-95f866f9c22d)
2026-01-30 15:58:20,894 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:932] - [read_sheet_values] Token email: johnhenry.bradley@gmail.com
2026-01-30 15:58:20,894 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:936] - [read_sheet_values] Successfully authenticated sheets service for user: johnhenry.bradley@gmail.com
2026-01-30 15:58:20,894 - gsheets.sheets_tools - INFO - 63695 - MainThread [sheets_tools.read_sheet_values:189] - [read_sheet_values] Invoked. Email: 'johnhenry.bradley@gmail.com', Spreadsheet: 1jZte5TaoCzmXtFeKacmzq-Sl7XuJBP5vDkyHg2mDwcQ, Range: A30:M50
2026-01-30 15:58:22,304 - gsheets.sheets_tools - INFO - 63695 - MainThread [sheets_tools.read_sheet_values:235] - Successfully read 14 rows for johnhenry.bradley@gmail.com.
2026-01-30 16:10:14,687 - mcp.server.lowlevel.server - INFO - 63695 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-30 16:10:14,688 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-30 16:10:14,688 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-30 16:10:14,688 - auth.service_decorator - INFO - 63695 - MainThread [service_decorator._get_auth_context:80] - [search_drive_files] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-30 16:10:14,688 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:868] - [search_drive_files] Attempting to get authenticated drive service. Email: 'johnhenry.bradley@gmail.com', Session: '3a811f7c-94cd-4f07-b6a3-95f866f9c22d'
2026-01-30 16:10:14,688 - auth.google_auth - INFO - 63695 - asyncio_0 [google_auth.get_credentials:575] - [get_credentials] Found OAuth 2.1 credentials for MCP session 3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-30 16:10:14,696 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:936] - [search_drive_files] Successfully authenticated drive service for user: johnhenry.bradley@gmail.com
2026-01-30 16:10:14,696 - gdrive.drive_tools - INFO - 63695 - MainThread [drive_tools.search_drive_files:75] - [search_drive_files] Invoked. Email: 'johnhenry.bradley@gmail.com', Query: 'name contains 'Pathfinder Guide' and mimeType = 'application/pdf''
2026-01-30 16:10:14,696 - gdrive.drive_tools - INFO - 63695 - MainThread [drive_tools.search_drive_files:85] - [search_drive_files] Using structured query as-is: 'name contains 'Pathfinder Guide' and mimeType = 'application/pdf''
2026-01-30 16:28:39,957 - mcp.server.lowlevel.server - INFO - 63695 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-30 16:28:39,959 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-30 16:28:39,959 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-30 16:28:39,960 - auth.service_decorator - INFO - 63695 - MainThread [service_decorator._get_auth_context:80] - [read_sheet_values] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-30 16:28:39,960 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:868] - [read_sheet_values] Attempting to get authenticated sheets service. Email: 'johnhenry.bradley@gmail.com', Session: '3a811f7c-94cd-4f07-b6a3-95f866f9c22d'
2026-01-30 16:28:39,961 - auth.google_auth - INFO - 63695 - asyncio_0 [google_auth.get_credentials:575] - [get_credentials] Found OAuth 2.1 credentials for MCP session 3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-30 16:28:39,972 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:936] - [read_sheet_values] Successfully authenticated sheets service for user: johnhenry.bradley@gmail.com
2026-01-30 16:28:39,972 - gsheets.sheets_tools - INFO - 63695 - MainThread [sheets_tools.read_sheet_values:189] - [read_sheet_values] Invoked. Email: 'johnhenry.bradley@gmail.com', Spreadsheet: 1jZte5TaoCzmXtFeKacmzq-Sl7XuJBP5vDkyHg2mDwcQ, Range: A1:M20
2026-01-30 16:28:41,180 - gsheets.sheets_tools - INFO - 63695 - MainThread [sheets_tools.read_sheet_values:235] - Successfully read 20 rows for johnhenry.bradley@gmail.com.
2026-01-30 16:31:13,523 - mcp.server.lowlevel.server - INFO - 63695 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-30 16:31:13,524 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-30 16:31:13,524 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-30 16:31:13,525 - auth.service_decorator - INFO - 63695 - MainThread [service_decorator._get_auth_context:80] - [read_sheet_values] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-30 16:31:13,525 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:868] - [read_sheet_values] Attempting to get authenticated sheets service. Email: 'johnhenry.bradley@gmail.com', Session: '3a811f7c-94cd-4f07-b6a3-95f866f9c22d'
2026-01-30 16:31:13,525 - auth.google_auth - INFO - 63695 - asyncio_0 [google_auth.get_credentials:575] - [get_credentials] Found OAuth 2.1 credentials for MCP session 3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-30 16:31:13,537 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:936] - [read_sheet_values] Successfully authenticated sheets service for user: johnhenry.bradley@gmail.com
2026-01-30 16:31:13,537 - gsheets.sheets_tools - INFO - 63695 - MainThread [sheets_tools.read_sheet_values:189] - [read_sheet_values] Invoked. Email: 'johnhenry.bradley@gmail.com', Spreadsheet: 1jZte5TaoCzmXtFeKacmzq-Sl7XuJBP5vDkyHg2mDwcQ, Range: A39:M45
2026-01-30 16:31:14,450 - gsheets.sheets_tools - INFO - 63695 - MainThread [sheets_tools.read_sheet_values:235] - Successfully read 5 rows for johnhenry.bradley@gmail.com.
2026-01-31 11:53:50,060 - mcp.server.lowlevel.server - INFO - 63695 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-31 11:53:50,061 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-31 11:53:50,061 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-31 11:53:50,061 - auth.service_decorator - INFO - 63695 - MainThread [service_decorator._get_auth_context:80] - [search_drive_files] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-31 11:53:50,062 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:868] - [search_drive_files] Attempting to get authenticated drive service. Email: 'example@example.com', Session: '3a811f7c-94cd-4f07-b6a3-95f866f9c22d'
2026-01-31 11:53:50,062 - auth.google_auth - INFO - 63695 - asyncio_0 [google_auth.get_credentials:575] - [get_credentials] Found OAuth 2.1 credentials for MCP session 3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-31 11:53:50,164 - auth.google_auth - INFO - 63695 - asyncio_0 [google_auth.get_credentials:593] - [get_credentials] Refreshed OAuth 2.1 credentials for session 3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-31 11:53:50,164 - auth.oauth21_session_store - INFO - 63695 - asyncio_0 [oauth21_session_store.store_session:360] - Stored OAuth 2.1 session for johnhenry.bradley@gmail.com (session_id: None, mcp_session_id: 3a811f7c-94cd-4f07-b6a3-95f866f9c22d)
2026-01-31 11:53:50,168 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:932] - [search_drive_files] Token email: johnhenry.bradley@gmail.com
2026-01-31 11:53:50,168 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:936] - [search_drive_files] Successfully authenticated drive service for user: johnhenry.bradley@gmail.com
2026-01-31 11:53:50,168 - gdrive.drive_tools - INFO - 63695 - MainThread [drive_tools.search_drive_files:75] - [search_drive_files] Invoked. Email: 'example@example.com', Query: 'name = 'IPB App Configuration' and mimeType = 'application/vnd.google-apps.spreadsheet''
2026-01-31 11:53:50,168 - gdrive.drive_tools - INFO - 63695 - MainThread [drive_tools.search_drive_files:85] - [search_drive_files] Using structured query as-is: 'name = 'IPB App Configuration' and mimeType = 'application/vnd.google-apps.spreadsheet''
2026-01-31 11:54:01,674 - mcp.server.lowlevel.server - INFO - 63695 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-31 11:54:01,674 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-31 11:54:01,674 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-31 11:54:01,674 - auth.service_decorator - INFO - 63695 - MainThread [service_decorator._get_auth_context:80] - [create_spreadsheet] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-31 11:54:01,674 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:868] - [create_spreadsheet] Attempting to get authenticated sheets service. Email: 'john.doe@example.com', Session: '3a811f7c-94cd-4f07-b6a3-95f866f9c22d'
2026-01-31 11:54:01,675 - auth.google_auth - INFO - 63695 - asyncio_0 [google_auth.get_credentials:575] - [get_credentials] Found OAuth 2.1 credentials for MCP session 3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-31 11:54:01,679 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:936] - [create_spreadsheet] Successfully authenticated sheets service for user: john.doe@example.com
2026-01-31 11:54:01,679 - gsheets.sheets_tools - INFO - 63695 - MainThread [sheets_tools.create_spreadsheet:924] - [create_spreadsheet] Invoked. Email: 'john.doe@example.com', Title: IPB App Configuration
2026-01-31 11:54:02,664 - gsheets.sheets_tools - INFO - 63695 - MainThread [sheets_tools.create_spreadsheet:954] - Successfully created spreadsheet for john.doe@example.com. ID: 14rRWyBXtb2H7jKfciDM_Wl9oU1FDgrwKJ9FGEbkbVuk
2026-01-31 11:54:19,485 - mcp.server.lowlevel.server - INFO - 63695 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-31 11:54:19,485 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-31 11:54:19,485 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-31 11:54:19,485 - auth.service_decorator - INFO - 63695 - MainThread [service_decorator._get_auth_context:80] - [modify_sheet_values] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-31 11:54:19,485 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:868] - [modify_sheet_values] Attempting to get authenticated sheets service. Email: 'john.doe@example.com', Session: '3a811f7c-94cd-4f07-b6a3-95f866f9c22d'
2026-01-31 11:54:19,486 - auth.google_auth - INFO - 63695 - asyncio_0 [google_auth.get_credentials:575] - [get_credentials] Found OAuth 2.1 credentials for MCP session 3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-31 11:54:19,494 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:936] - [modify_sheet_values] Successfully authenticated sheets service for user: john.doe@example.com
2026-01-31 11:54:19,494 - gsheets.sheets_tools - INFO - 63695 - MainThread [sheets_tools.modify_sheet_values:266] - [modify_sheet_values] Invoked. Operation: write, Email: 'john.doe@example.com', Spreadsheet: 14rRWyBXtb2H7jKfciDM_Wl9oU1FDgrwKJ9FGEbkbVuk, Range: Sheet1!A1
2026-01-31 11:54:20,607 - gsheets.sheets_tools - INFO - 63695 - MainThread [sheets_tools.modify_sheet_values:361] - Successfully updated 75 cells for john.doe@example.com.
2026-01-31 11:55:23,713 - mcp.server.lowlevel.server - INFO - 63695 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-31 11:55:23,714 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-31 11:55:23,714 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-31 11:55:23,714 - auth.service_decorator - INFO - 63695 - MainThread [service_decorator._get_auth_context:80] - [get_drive_file_permissions] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-31 11:55:23,714 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:868] - [get_drive_file_permissions] Attempting to get authenticated drive service. Email: 'john.doe@example.com', Session: '3a811f7c-94cd-4f07-b6a3-95f866f9c22d'
2026-01-31 11:55:23,714 - auth.google_auth - INFO - 63695 - asyncio_0 [google_auth.get_credentials:575] - [get_credentials] Found OAuth 2.1 credentials for MCP session 3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-31 11:55:23,720 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:936] - [get_drive_file_permissions] Successfully authenticated drive service for user: john.doe@example.com
2026-01-31 11:55:23,720 - gdrive.drive_tools - INFO - 63695 - MainThread [drive_tools.get_drive_file_permissions:708] - [get_drive_file_permissions] Checking file 14rRWyBXtb2H7jKfciDM_Wl9oU1FDgrwKJ9FGEbkbVuk for john.doe@example.com
2026-01-31 11:55:34,716 - mcp.server.lowlevel.server - INFO - 63695 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-31 11:55:34,716 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-31 11:55:34,716 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-31 11:55:34,716 - auth.service_decorator - INFO - 63695 - MainThread [service_decorator._get_auth_context:80] - [share_drive_file] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-31 11:55:34,716 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:868] - [share_drive_file] Attempting to get authenticated drive service. Email: 'john.doe@example.com', Session: '3a811f7c-94cd-4f07-b6a3-95f866f9c22d'
2026-01-31 11:55:34,717 - auth.google_auth - INFO - 63695 - asyncio_0 [google_auth.get_credentials:575] - [get_credentials] Found OAuth 2.1 credentials for MCP session 3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-31 11:55:34,719 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:936] - [share_drive_file] Successfully authenticated drive service for user: john.doe@example.com
2026-01-31 11:55:34,719 - gdrive.drive_tools - INFO - 63695 - MainThread [drive_tools.share_drive_file:1165] - [share_drive_file] Invoked. Email: 'john.doe@example.com', File ID: '14rRWyBXtb2H7jKfciDM_Wl9oU1FDgrwKJ9FGEbkbVuk', Share with: 'None', Role: 'reader', Type: 'anyone'
2026-01-31 15:41:08,687 - mcp.server.lowlevel.server - INFO - 63695 - MainThread [server._handle_request:720] - Processing request of type CallToolRequest
2026-01-31 15:41:08,688 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:74] - [AuthInfoMiddleware] get_http_headers() returned: True, keys: None
2026-01-31 15:41:08,688 - auth.auth_info_middleware - INFO - 63695 - MainThread [auth_info_middleware._process_request_for_auth:390] -  Authenticated via stdio_single_session: johnhenry.bradley@gmail.com
2026-01-31 15:41:08,688 - auth.service_decorator - INFO - 63695 - MainThread [service_decorator._get_auth_context:80] - [create_drive_file] Auth from middleware: authenticated_user=johnhenry.bradley@gmail.com, auth_method=stdio_single_session, session_id=3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-31 15:41:08,688 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:868] - [create_drive_file] Attempting to get authenticated drive service. Email: 'johnhenry.bradley@gmail.com', Session: '3a811f7c-94cd-4f07-b6a3-95f866f9c22d'
2026-01-31 15:41:08,688 - auth.google_auth - INFO - 63695 - asyncio_0 [google_auth.get_credentials:575] - [get_credentials] Found OAuth 2.1 credentials for MCP session 3a811f7c-94cd-4f07-b6a3-95f866f9c22d
2026-01-31 15:41:08,688 - auth.google_auth - ERROR - 63695 - asyncio_0 [google_auth.get_credentials:609] - [get_credentials] Failed to refresh OAuth 2.1 credentials: The credentials do not contain the necessary fields need to refresh the access token. You must specify refresh_token, token_uri, client_id, and client_secret.
2026-01-31 15:41:08,689 - auth.google_auth - WARNING - 63695 - MainThread [google_auth.get_authenticated_google_service:887] - [create_drive_file] No valid credentials. Email: 'johnhenry.bradley@gmail.com'.
2026-01-31 15:41:08,689 - auth.google_auth - INFO - 63695 - MainThread [google_auth.get_authenticated_google_service:890] - [create_drive_file] Valid email 'johnhenry.bradley@gmail.com' provided, initiating auth flow.
2026-01-31 15:41:08,689 - auth.oauth_callback_server - INFO - 63695 - MainThread [oauth_callback_server.ensure_oauth_callback_available:261] - Starting minimal OAuth server for stdio mode
2026-01-31 15:41:08,791 - auth.oauth_callback_server - INFO - 63695 - MainThread [oauth_callback_server.start:192] - Minimal OAuth server started on localhost:8081
2026-01-31 15:41:08,792 - auth.oauth_callback_server - INFO - 63695 - MainThread [oauth_callback_server.ensure_oauth_callback_available:264] - Minimal OAuth server successfully started on http://localhost:8081
2026-01-31 15:41:08,792 - auth.google_auth - INFO - 63695 - MainThread [google_auth.start_auth_flow:357] - [start_auth_flow] Initiating auth for Google Drive for 'johnhenry.bradley@gmail.com' with scopes for enabled tools.
2026-01-31 15:41:08,792 - auth.google_auth - WARNING - 63695 - MainThread [google_auth.start_auth_flow:367] - OAUTHLIB_INSECURE_TRANSPORT not set. Setting it for localhost/local development.
2026-01-31 15:41:08,793 - auth.google_auth - INFO - 63695 - MainThread [google_auth.start_auth_flow:393] - Auth flow started for Google Drive for 'johnhenry.bradley@gmail.com'. State: 5fadd05d... Advise user to visit: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file&state=5fadd05d7fd653014b29e31b91e9ed8b&access_type=offline&prompt=consent
2026-01-31 15:41:08,793 - auth.service_decorator - ERROR - 63695 - MainThread [service_decorator.wrapper:664] - [create_drive_file] GoogleAuthenticationError during authentication. Method=stdio_single_session, User=johnhenry.bradley@gmail.com, Service=drive vv3, MCPSessionID=3a811f7c-94cd-4f07-b6a3-95f866f9c22d: **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'johnhenry.bradley@gmail.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file&state=5fadd05d7fd653014b29e31b91e9ed8b&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file&state=5fadd05d7fd653014b29e31b91e9ed8b&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'johnhenry.bradley@gmail.com' was provided, it must match the authenticated account.
2026-01-31 15:41:08,861 - auth.auth_info_middleware - ERROR - 63695 - MainThread [auth_info_middleware.on_call_tool:414] - Error in on_call_tool middleware: Error calling tool 'create_drive_file': **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'johnhenry.bradley@gmail.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file&state=5fadd05d7fd653014b29e31b91e9ed8b&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file&state=5fadd05d7fd653014b29e31b91e9ed8b&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'johnhenry.bradley@gmail.com' was provided, it must match the authenticated account.
Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 160, in call_tool
    return await tool.run(arguments)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool.py", line 383, in run
    result = await result
             ^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/core/utils.py", line 272, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 653, in wrapper
    service, actual_user_email = await _authenticate_service(
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/service_decorator.py", line 215, in _authenticate_service
    return await get_authenticated_google_service(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/google_auth.py", line 916, in get_authenticated_google_service
    raise GoogleAuthenticationError(auth_response)
auth.google_auth.GoogleAuthenticationError: **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'johnhenry.bradley@gmail.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file&state=5fadd05d7fd653014b29e31b91e9ed8b&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file&state=5fadd05d7fd653014b29e31b91e9ed8b&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'johnhenry.bradley@gmail.com' was provided, it must match the authenticated account.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/auth/auth_info_middleware.py", line 403, in on_call_tool
    result = await call_next(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/server/server.py", line 1678, in _call_tool
    return await self._tool_manager.call_tool(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/antigravity-mcp/venv/lib/python3.12/site-packages/fastmcp/tools/tool_manager.py", line 170, in call_tool
    raise ToolError(f"Error calling tool {key!r}: {e}") from e
fastmcp.exceptions.ToolError: Error calling tool 'create_drive_file': **ACTION REQUIRED: Google Authentication Needed for Google Drive for 'johnhenry.bradley@gmail.com'**

To proceed, the user must authorize this application for Google Drive access using all required permissions.
**LLM, please present this exact authorization URL to the user as a clickable hyperlink:**
Authorization URL: https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file&state=5fadd05d7fd653014b29e31b91e9ed8b&access_type=offline&prompt=consent
Markdown for hyperlink: [Click here to authorize Google Drive access](https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=79186948657-m72onn75jm78okqirsbsk0jgv3ke9uql.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8081%2Foauth2callback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdocuments+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file&state=5fadd05d7fd653014b29e31b91e9ed8b&access_type=offline&prompt=consent)

**LLM, after presenting the link, instruct the user as follows:**
1. Click the link and complete the authorization in their browser.
2. After successful authorization, **retry their original command**.

The application will use the new credentials. If 'johnhenry.bradley@gmail.com' was provided, it must match the authenticated account.
2026-01-31 15:41:08,862 - mcp.server.lowlevel.server - INFO - 63695 - MainThread [server._handle_message:710] - Warning: DeprecationWarning: websockets.legacy is deprecated; see https://websockets.readthedocs.io/en/stable/howto/upgrade.html for upgrade instructions
2026-01-31 15:41:08,862 - mcp.server.lowlevel.server - INFO - 63695 - MainThread [server._handle_message:710] - Warning: DeprecationWarning: websockets.server.WebSocketServerProtocol is deprecated
